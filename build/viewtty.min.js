(()=>{(()=>{var Y=Object.create,K=Object.defineProperty,X=Object.getOwnPropertyDescriptor,H=Object.getOwnPropertyNames,G=Object.getPrototypeOf,W=Object.prototype.hasOwnProperty,z=(y,b)=>function(){return b||(0,y[H(y)[0]])((b={exports:{}}).exports,b),b.exports},$=(y,b,x,v)=>{if(b&&typeof b=="object"||typeof b=="function")for(let m of H(b))!W.call(y,m)&&m!==x&&K(y,m,{get:()=>b[m],enumerable:!(v=X(b,m))||v.enumerable});return y},J=(y,b,x)=>(x=y!=null?Y(G(y)):{},$(b||!y||!y.__esModule?K(x,"default",{value:y,enumerable:!0}):x,y)),Z=z({"ext/term.cjs"(y,b){(function(){"use strict";var x=this,v=this.document;function m(){this._events=this._events||{}}m.prototype.addListener=function(t,s){this._events[t]=this._events[t]||[],this._events[t].push(s)},m.prototype.on=m.prototype.addListener,m.prototype.removeListener=function(t,s){if(this._events[t]){for(var e=this._events[t],r=e.length;r--;)if(e[r]===s||e[r].listener===s){e.splice(r,1);return}}},m.prototype.off=m.prototype.removeListener,m.prototype.removeAllListeners=function(t){this._events[t]&&delete this._events[t]},m.prototype.once=function(t,s){function e(){var r=Array.prototype.slice.call(arguments);return this.removeListener(t,e),s.apply(this,r)}return e.listener=s,this.on(t,e)},m.prototype.emit=function(t){if(this._events[t])for(var s=Array.prototype.slice.call(arguments,1),e=this._events[t],r=e.length,l=0;l<r;l++)e[l].apply(this,s)},m.prototype.listeners=function(t){return this._events[t]=this._events[t]||[]};var w=0,_=1,D=2,P=3,L=4,I=5,F=6;function h(t){var s=this;if(!(this instanceof h))return new h(arguments[0],arguments[1],arguments[2]);m.call(this),typeof t=="number"&&(t={cols:arguments[0],rows:arguments[1],handler:arguments[2]}),t=t||{},V(j(h.defaults),function(r){t[r]==null&&(t[r]=h.options[r],h[r]!==h.defaults[r]&&(t[r]=h[r])),s[r]=t[r]}),t.colors.length===8?t.colors=t.colors.concat(h._colors.slice(8)):t.colors.length===16?t.colors=t.colors.concat(h._colors.slice(16)):t.colors.length===10?t.colors=t.colors.slice(0,-2).concat(h._colors.slice(8,-2),t.colors.slice(-2)):t.colors.length===18&&(t.colors=t.colors.slice(0,-2).concat(h._colors.slice(16,-2),t.colors.slice(-2))),this.colors=t.colors,this.options=t,this.parent=t.body||t.parent||(v?v.getElementsByTagName("body")[0]:null),this.cols=t.cols||t.geometry[0],this.rows=t.rows||t.geometry[1],t.handler&&this.on("data",t.handler),this.ybase=0,this.ydisp=0,this.x=0,this.y=0,this.cursorState=0,this.cursorHidden=!1,this.convertEol,this.state=0,this.queue="",this.scrollTop=0,this.scrollBottom=this.rows-1,this.applicationKeypad=!1,this.applicationCursor=!1,this.originMode=!1,this.insertMode=!1,this.wraparoundMode=!1,this.normal=null,this.prefixMode=!1,this.selectMode=!1,this.visualMode=!1,this.searchMode=!1,this.searchDown,this.entry="",this.entryPrefix="Search: ",this._real,this._selected,this._textarea,this.charset=null,this.gcharset=null,this.glevel=0,this.charsets=[null],this.decLocator,this.x10Mouse,this.vt200Mouse,this.vt300Mouse,this.normalMouse,this.mouseEvents,this.sendFocus,this.utfMouse,this.sgrMouse,this.urxvtMouse,this.element,this.children,this.refreshStart,this.refreshEnd,this.savedX,this.savedY,this.savedCols,this.readable=!0,this.writable=!0,this.defAttr=131840,this.curAttr=this.defAttr,this.params=[],this.currentParam=0,this.prefix="",this.postfix="",this.lines=[];for(var e=this.rows;e--;)this.lines.push(this.blankLine());this.tabs,this.setupStops()}N(h,m),h.prototype.eraseAttr=function(){return this.defAttr&-512|this.curAttr&511},h.tangoColors=["#2e3436","#cc0000","#4e9a06","#c4a000","#3465a4","#75507b","#06989a","#d3d7cf","#555753","#ef2929","#8ae234","#fce94f","#729fcf","#ad7fa8","#34e2e2","#eeeeec"],h.xtermColors=["#000000","#cd0000","#00cd00","#cdcd00","#0000ee","#cd00cd","#00cdcd","#e5e5e5","#7f7f7f","#ff0000","#00ff00","#ffff00","#5c5cff","#ff00ff","#00ffff","#ffffff"],h.colors=function(){var t=h.tangoColors.slice(),s=[0,95,135,175,215,255],e;for(e=0;e<216;e++)r(s[e/36%6|0],s[e/6%6|0],s[e%6]);for(e=0;e<24;e++)s=8+e*10,r(s,s,s);function r(a,n,u){t.push("#"+l(a)+l(n)+l(u))}function l(a){return a=a.toString(16),a.length<2?"0"+a:a}return t}(),h.colors[256]="#000000",h.colors[257]="#f0f0f0",h._colors=h.colors.slice(),h.vcolors=function(){for(var t=[],s=h.colors,e=0,r;e<256;e++)r=parseInt(s[e].substring(1),16),t.push([r>>16&255,r>>8&255,r&255]);return t}(),h.defaults={colors:h.colors,convertEol:!1,termName:"xterm",geometry:[80,24],cursorBlink:!0,visualBell:!1,popOnBell:!1,scrollback:1e3,screenKeys:!1,debug:!1,useStyle:!1},h.options={},V(j(h.defaults),function(t){h[t]=h.defaults[t],h.options[t]=h.defaults[t]}),h.focus=null,h.prototype.focus=function(){h.focus!==this&&(h.focus&&h.focus.blur(),this.sendFocus&&this.send("\x1B[I"),this.showCursor(),h.focus=this)},h.prototype.blur=function(){h.focus===this&&(this.cursorState=0,this.refresh(this.y,this.y),this.sendFocus&&this.send("\x1B[O"),h.focus=null)},h.prototype.initGlobal=function(){var t=this.document;h._boundDocs=h._boundDocs||[],!~et(h._boundDocs,t)&&(h._boundDocs.push(t),h.bindPaste(t),h.bindKeys(t),h.bindCopy(t),this.isMobile&&this.fixMobile(t),this.useStyle&&h.insertStyle(t,this.colors[256],this.colors[257]))},h.bindPaste=function(t){var s=t.defaultView;B(s,"paste",function(e){var r=h.focus;if(r)return e.clipboardData?r.send(e.clipboardData.getData("text/plain")):r.context.clipboardData&&r.send(r.context.clipboardData.getData("Text")),r.element.contentEditable="inherit",C(e)})},h.bindKeys=function(t){B(t,"keydown",function(s){if(h.focus){var e=s.target||s.srcElement;if(e&&(e===h.focus.element||e===h.focus.context||e===h.focus.document||e===h.focus.body||e===h._textarea||e===h.focus.parent))return h.focus.keyDown(s)}},!0),B(t,"keypress",function(s){if(h.focus){var e=s.target||s.srcElement;if(e&&(e===h.focus.element||e===h.focus.context||e===h.focus.document||e===h.focus.body||e===h._textarea||e===h.focus.parent))return h.focus.keyPress(s)}},!0),B(t,"mousedown",function(s){if(h.focus){var e=s.target||s.srcElement;if(e){do if(e===h.focus.element)return;while(e=e.parentNode);h.focus.blur()}}})},h.bindCopy=function(t){var s=t.defaultView;B(s,"copy",function(e){var r=h.focus;if(r&&r._selected){var l=r.getCopyTextarea(),a=r.grabText(r._selected.x1,r._selected.x2,r._selected.y1,r._selected.y2);r.emit("copy",a),l.focus(),l.textContent=a,l.value=a,l.setSelectionRange(0,a.length),A(function(){r.element.focus(),r.focus()},1)}})},h.prototype.fixMobile=function(t){var s=this,e=t.createElement("textarea");e.style.position="absolute",e.style.left="-32000px",e.style.top="-32000px",e.style.width="0px",e.style.height="0px",e.style.opacity="0",e.style.backgroundColor="transparent",e.style.borderStyle="none",e.style.outlineStyle="none",e.autocapitalize="none",e.autocorrect="off",t.getElementsByTagName("body")[0].appendChild(e),h._textarea=e,A(function(){e.focus()},1e3),this.isAndroid&&B(e,"change",function(){var r=e.textContent||e.value;e.value="",e.textContent="",s.send(r+"\r")})},h.insertStyle=function(t,s,e){var l=t.getElementById("term-style");if(!l){var r=t.getElementsByTagName("head")[0];if(r){var l=t.createElement("style");l.id="term-style",l.innerHTML=`.terminal {
  float: left;
  border: `+s+` solid 5px;
  font-family: "DejaVu Sans Mono", "Liberation Mono", monospace;
  font-size: 11px;
  color: `+e+`;
  background: `+s+`;
}

.terminal-cursor {
  color: `+s+`;
  background: `+e+`;
}
`,r.insertBefore(l,r.firstChild)}}},h.prototype.open=function(t){var s=this,e=0,r;if(this.parent=t||this.parent,!this.parent)throw new Error("Terminal requires a parent element.");for(this.context=this.parent.ownerDocument.defaultView,this.document=this.parent.ownerDocument,this.body=this.document.getElementsByTagName("body")[0],this.context.navigator&&this.context.navigator.userAgent&&(this.isMac=!!~this.context.navigator.userAgent.indexOf("Mac"),this.isIpad=!!~this.context.navigator.userAgent.indexOf("iPad"),this.isIphone=!!~this.context.navigator.userAgent.indexOf("iPhone"),this.isAndroid=!!~this.context.navigator.userAgent.indexOf("Android"),this.isMobile=this.isIpad||this.isIphone||this.isAndroid,this.isMSIE=!!~this.context.navigator.userAgent.indexOf("MSIE")),this.element=this.document.createElement("div"),this.element.className="terminal",this.element.style.outline="none",this.element.setAttribute("tabindex",0),this.element.setAttribute("spellcheck","false"),this.element.style.backgroundColor=this.colors[256],this.element.style.color=this.colors[257],this.children=[];e<this.rows;e++)r=this.document.createElement("div"),this.element.appendChild(r),this.children.push(r);this.parent.appendChild(this.element),this.refresh(0,this.rows-1),this.options.noEvents&&this.initGlobal(),this.options.noFocus||(this.focus(),this.startBlink(),B(this.element,"focus",function(){s.focus(),s.isMobile&&h._textarea.focus()}),B(this.element,"mousedown",function(){s.focus()}),B(this.element,"mousedown",function(l){var a=l.button!=null?+l.button:l.which!=null?l.which-1:null;s.isMSIE&&(a=a===1?0:a===4?1:a),a===2&&(s.element.contentEditable="true",A(function(){s.element.contentEditable="inherit"},1))},!0)),this.options.noMouse&&this.bindMouse(),this.options.noFocus||A(function(){s.element.focus()},100),h.brokenBold==null&&(h.brokenBold=st(this.document))},h.prototype.bindMouse=function(){var t=this.element,s=this,e=32,r="onmousewheel"in this.context?"mousewheel":"DOMMouseScroll";function l(o){var c,f;if(c=p(o),f=d(o),!!f)switch(u(c,f),o.type){case"mousedown":e=c;break;case"mouseup":e=32;break;case r:break}}function a(o){var c=e,f;f=d(o),f&&(c+=32,u(c,f))}function n(o,c){if(s.utfMouse){if(c===2047)return o.push(0);c<127?o.push(c):(c>2047&&(c=2047),o.push(192|c>>6),o.push(128|c&63))}else{if(c===255)return o.push(0);c>127&&(c=127),o.push(c)}}function u(o,c){if(s.vt300Mouse){o&=3,c.x-=32,c.y-=32;var f="\x1B[24";if(o===0)f+="1";else if(o===1)f+="3";else if(o===2)f+="5";else{if(o===3)return;f+="0"}f+="~["+c.x+","+c.y+"]\r",s.send(f);return}if(s.decLocator){o&=3,c.x-=32,c.y-=32,o===0?o=2:o===1?o=4:o===2?o=6:o===3&&(o=3),s.send("\x1B["+o+";"+(o===3?4:0)+";"+c.y+";"+c.x+";"+(c.page||0)+"&w");return}if(s.urxvtMouse){c.x-=32,c.y-=32,c.x++,c.y++,s.send("\x1B["+o+";"+c.x+";"+c.y+"M");return}if(s.sgrMouse){c.x-=32,c.y-=32,s.send("\x1B[<"+((o&3)===3?o&-4:o)+";"+c.x+";"+c.y+((o&3)===3?"m":"M"));return}var f=[];n(f,o),n(f,c.x),n(f,c.y),s.send("\x1B[M"+S.fromCharCode.apply(S,f))}function p(o){var c,f,g,k,M;switch(o.type){case"mousedown":c=o.button!=null?+o.button:o.which!=null?o.which-1:null,s.isMSIE&&(c=c===1?0:c===4?1:c);break;case"mouseup":c=3;break;case"DOMMouseScroll":c=o.detail<0?64:65;break;case"mousewheel":c=o.wheelDeltaY>0?64:65;break}return f=o.shiftKey?4:0,g=o.metaKey?8:0,k=o.ctrlKey?16:0,M=f|g|k,s.vt200Mouse?M&=k:s.normalMouse||(M=0),c=32+(M<<2)+c,c}function d(o){var c,f,g,k,M;if(o.pageX!=null){for(c=o.pageX,f=o.pageY,M=s.element;M&&M!==s.document.documentElement;)c-=M.offsetLeft,f-=M.offsetTop,M="offsetParent"in M?M.offsetParent:M.parentNode;return g=s.element.clientWidth,k=s.element.clientHeight,c=Math.round(c/g*s.cols),f=Math.round(f/k*s.rows),c<0&&(c=0),c>s.cols&&(c=s.cols),f<0&&(f=0),f>s.rows&&(f=s.rows),c+=32,f+=32,{x:c,y:f,type:o.type===r?"mousewheel":o.type}}}B(t,"mousedown",function(o){if(s.mouseEvents)return l(o),s.focus(),s.vt200Mouse?(l({__proto__:o,type:"mouseup"}),C(o)):(s.normalMouse&&B(s.document,"mousemove",a),s.x10Mouse||B(s.document,"mouseup",function c(f){return l(f),s.normalMouse&&R(s.document,"mousemove",a),R(s.document,"mouseup",c),C(f)}),C(o))}),B(t,r,function(o){if(s.mouseEvents&&!(s.x10Mouse||s.vt300Mouse||s.decLocator))return l(o),C(o)}),B(t,r,function(o){if(!s.mouseEvents&&!s.applicationKeypad)return o.type==="DOMMouseScroll"?s.scrollDisp(o.detail<0?-5:5):s.scrollDisp(o.wheelDeltaY>0?-5:5),C(o)})},h.prototype.destroy=function(){this.readable=!1,this.writable=!1,this._events={},this.handler=function(){},this.write=function(){},this.element.parentNode&&this.element.parentNode.removeChild(this.element)},h.prototype.refresh=function(t,s){var e,r,l,a,n,u,p,d,o,c,f,g,k,M;for(s-t>=this.rows/2&&(M=this.element.parentNode,M&&M.removeChild(this.element)),p=this.cols,r=t,s>=this.lines.length&&(this.log("`end` is too large. Most likely a bad CSR."),s=this.lines.length-1);r<=s;r++){for(k=r+this.ydisp,a=this.lines[k],n="",r===this.y&&this.cursorState&&(this.ydisp===this.ybase||this.selectMode)&&!this.cursorHidden?e=this.x:e=-1,o=this.defAttr,l=0;l<p;l++){switch(d=a[l][0],u=a[l][1],l===e&&(d=-1),d!==o&&(o!==this.defAttr&&(n+="</span>"),d!==this.defAttr&&(d===-1?n+='<span class="reverse-video terminal-cursor">':(n+='<span style="',c=d&511,f=d>>9&511,g=d>>18,g&1&&(h.brokenBold||(n+="font-weight:bold;"),f<8&&(f+=8)),g&2&&(n+="text-decoration:underline;"),g&4&&(g&2?(n=n.slice(0,-1),n+=" blink;"):n+="text-decoration:blink;"),g&8&&(c=d>>9&511,f=d&511,g&1&&f<8&&(f+=8)),g&16&&(n+="visibility:hidden;"),c!==256&&(n+="background-color:"+this.colors[c]+";"),f!==257&&(n+="color:"+this.colors[f]+";"),n+='">'))),u){case"&":n+="&amp;";break;case"<":n+="&lt;";break;case">":n+="&gt;";break;default:u<=" "?n+="&nbsp;":(O(u)&&l++,n+=u);break}o=d}o!==this.defAttr&&(n+="</span>"),this.children[r].innerHTML=n}M&&M.appendChild(this.element)},h.prototype._cursorBlink=function(){h.focus===this&&(this.cursorState^=1,this.refresh(this.y,this.y))},h.prototype.showCursor=function(){this.cursorState||(this.cursorState=1,this.refresh(this.y,this.y))},h.prototype.startBlink=function(){if(this.cursorBlink){var t=this;this._blinker=function(){t._cursorBlink()},this._blink=U(this._blinker,500)}},h.prototype.refreshBlink=function(){this.cursorBlink&&(clearInterval(this._blink),this._blink=U(this._blinker,500))},h.prototype.scroll=function(){var t;++this.ybase===this.scrollback&&(this.ybase=this.ybase/2|0,this.lines=this.lines.slice(-(this.ybase+this.rows)+1)),this.ydisp=this.ybase,t=this.ybase+this.rows-1,t-=this.rows-1-this.scrollBottom,t===this.lines.length?this.lines.push(this.blankLine()):this.lines.splice(t,0,this.blankLine()),this.scrollTop!==0&&(this.ybase!==0&&(this.ybase--,this.ydisp=this.ybase),this.lines.splice(this.ybase+this.scrollTop,1)),this.updateRange(this.scrollTop),this.updateRange(this.scrollBottom)},h.prototype.scrollDisp=function(t){this.ydisp+=t,this.ydisp>this.ybase?this.ydisp=this.ybase:this.ydisp<0&&(this.ydisp=0),this.refresh(0,this.rows-1)},h.prototype.write=function(t){var s=t.length,e=0,r,l,a;for(this.refreshStart=this.y,this.refreshEnd=this.y,this.ybase!==this.ydisp&&(this.ydisp=this.ybase,this.maxRange());e<s;e++)switch(a=t[e],this.state){case w:switch(a){case"\x07":this.bell();break;case`
`:case"\v":case"\f":this.convertEol&&(this.x=0),this.y++,this.y>this.scrollBottom&&(this.y--,this.scroll());break;case"\r":this.x=0;break;case"\b":this.x>0&&this.x--;break;case"	":this.x=this.nextStop();break;case"":this.setgLevel(1);break;case"":this.setgLevel(0);break;case"\x1B":this.state=_;break;default:if(a>=" "&&(this.charset&&this.charset[a]&&(a=this.charset[a]),this.x>=this.cols&&(this.x=0,this.y++,this.y>this.scrollBottom&&(this.y--,this.scroll())),this.lines[this.y+this.ybase][this.x]=[this.curAttr,a],this.x++,this.updateRange(this.y),O(a))){if(r=this.y+this.ybase,this.cols<2||this.x>=this.cols){this.lines[r][this.x-1]=[this.curAttr," "];break}this.lines[r][this.x]=[this.curAttr," "],this.x++}break}break;case _:switch(a){case"[":this.params=[],this.currentParam=0,this.state=D;break;case"]":this.params=[],this.currentParam=0,this.state=P;break;case"P":this.params=[],this.currentParam=0,this.state=I;break;case"_":this.state=F;break;case"^":this.state=F;break;case"c":this.reset();break;case"E":this.x=0;case"D":this.index();break;case"M":this.reverseIndex();break;case"%":this.setgLevel(0),this.setgCharset(0,h.charsets.US),this.state=w,e++;break;case"(":case")":case"*":case"+":case"-":case".":switch(a){case"(":this.gcharset=0;break;case")":this.gcharset=1;break;case"*":this.gcharset=2;break;case"+":this.gcharset=3;break;case"-":this.gcharset=1;break;case".":this.gcharset=2;break}this.state=L;break;case"/":this.gcharset=3,this.state=L,e--;break;case"N":break;case"O":break;case"n":this.setgLevel(2);break;case"o":this.setgLevel(3);break;case"|":this.setgLevel(3);break;case"}":this.setgLevel(2);break;case"~":this.setgLevel(1);break;case"7":this.saveCursor(),this.state=w;break;case"8":this.restoreCursor(),this.state=w;break;case"#":this.state=w,e++;break;case"H":this.tabSet();break;case"=":this.log("Serial port requested application keypad."),this.applicationKeypad=!0,this.state=w;break;case">":this.log("Switching back to normal keypad."),this.applicationKeypad=!1,this.state=w;break;default:this.state=w,this.error("Unknown ESC control: %s.",a);break}break;case L:switch(a){case"0":l=h.charsets.SCLD;break;case"A":l=h.charsets.UK;break;case"B":l=h.charsets.US;break;case"4":l=h.charsets.Dutch;break;case"C":case"5":l=h.charsets.Finnish;break;case"R":l=h.charsets.French;break;case"Q":l=h.charsets.FrenchCanadian;break;case"K":l=h.charsets.German;break;case"Y":l=h.charsets.Italian;break;case"E":case"6":l=h.charsets.NorwegianDanish;break;case"Z":l=h.charsets.Spanish;break;case"H":case"7":l=h.charsets.Swedish;break;case"=":l=h.charsets.Swiss;break;case"/":l=h.charsets.ISOLatin,e++;break;default:l=h.charsets.US;break}this.setgCharset(this.gcharset,l),this.gcharset=null,this.state=w;break;case P:if(a==="\x1B"||a==="\x07"){switch(a==="\x1B"&&e++,this.params.push(this.currentParam),this.params[0]){case 0:case 1:case 2:this.params[1]&&(this.title=this.params[1],this.handleTitle(this.title));break;case 3:break;case 4:case 5:break;case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:break;case 46:break;case 50:break;case 51:break;case 52:break;case 104:case 105:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:break}this.params=[],this.currentParam=0,this.state=w}else this.params.length?this.currentParam+=a:a>="0"&&a<="9"?this.currentParam=this.currentParam*10+a.charCodeAt(0)-48:a===";"&&(this.params.push(this.currentParam),this.currentParam="");break;case D:if(a==="?"||a===">"||a==="!"){this.prefix=a;break}if(a>="0"&&a<="9"){this.currentParam=this.currentParam*10+a.charCodeAt(0)-48;break}if(a==="$"||a==='"'||a===" "||a==="'"){this.postfix=a;break}if(this.params.push(this.currentParam),this.currentParam=0,a===";")break;switch(this.state=w,a){case"A":this.cursorUp(this.params);break;case"B":this.cursorDown(this.params);break;case"C":this.cursorForward(this.params);break;case"D":this.cursorBackward(this.params);break;case"H":this.cursorPos(this.params);break;case"J":this.eraseInDisplay(this.params);break;case"K":this.eraseInLine(this.params);break;case"m":this.prefix||this.charAttributes(this.params);break;case"n":this.prefix||this.deviceStatus(this.params);break;case"@":this.insertChars(this.params);break;case"E":this.cursorNextLine(this.params);break;case"F":this.cursorPrecedingLine(this.params);break;case"G":this.cursorCharAbsolute(this.params);break;case"L":this.insertLines(this.params);break;case"M":this.deleteLines(this.params);break;case"P":this.deleteChars(this.params);break;case"X":this.eraseChars(this.params);break;case"`":this.charPosAbsolute(this.params);break;case"a":this.HPositionRelative(this.params);break;case"c":this.sendDeviceAttributes(this.params);break;case"d":this.linePosAbsolute(this.params);break;case"e":this.VPositionRelative(this.params);break;case"f":this.HVPosition(this.params);break;case"h":this.setMode(this.params);break;case"l":this.resetMode(this.params);break;case"r":this.setScrollRegion(this.params);break;case"s":this.saveCursor(this.params);break;case"u":this.restoreCursor(this.params);break;case"I":this.cursorForwardTab(this.params);break;case"S":this.scrollUp(this.params);break;case"T":this.params.length<2&&!this.prefix&&this.scrollDown(this.params);break;case"Z":this.cursorBackwardTab(this.params);break;case"b":this.repeatPrecedingCharacter(this.params);break;case"g":this.tabClear(this.params);break;case"p":switch(this.prefix){case"!":this.softReset(this.params);break}break;default:this.error("Unknown CSI code: %s.",a);break}this.prefix="",this.postfix="";break;case I:if(a==="\x1B"||a==="\x07"){switch(a==="\x1B"&&e++,this.prefix){case"":break;case"$q":var n=this.currentParam,u=!1;switch(n){case'"q':n='0"q';break;case'"p':n='61"p';break;case"r":n=""+(this.scrollTop+1)+";"+(this.scrollBottom+1)+"r";break;case"m":n="0m";break;default:this.error("Unknown DCS Pt: %s.",n),n="";break}this.send("\x1BP"+ +u+"$r"+n+"\x1B\\");break;case"+p":break;case"+q":var n=this.currentParam,u=!1;this.send("\x1BP"+ +u+"+r"+n+"\x1B\\");break;default:this.error("Unknown DCS prefix: %s.",this.prefix);break}this.currentParam=0,this.prefix="",this.state=w}else this.currentParam?this.currentParam+=a:!this.prefix&&a!=="$"&&a!=="+"?this.currentParam=a:this.prefix.length===2?this.currentParam=a:this.prefix+=a;break;case F:(a==="\x1B"||a==="\x07")&&(a==="\x1B"&&e++,this.state=w);break}this.updateRange(this.y),this.refresh(this.refreshStart,this.refreshEnd)},h.prototype.writeln=function(t){this.write(t+`\r
`)},h.prototype.keyDown=function(t){var s=this,e;switch(t.keyCode){case 8:if(t.shiftKey){e="\b";break}e="\x7F";break;case 9:if(t.shiftKey){e="\x1B[Z";break}e="	";break;case 13:e="\r";break;case 27:e="\x1B";break;case 37:if(this.applicationCursor){e="\x1BOD";break}e="\x1B[D";break;case 39:if(this.applicationCursor){e="\x1BOC";break}e="\x1B[C";break;case 38:if(this.applicationCursor){e="\x1BOA";break}if(t.ctrlKey)return this.scrollDisp(-1),C(t);e="\x1B[A";break;case 40:if(this.applicationCursor){e="\x1BOB";break}if(t.ctrlKey)return this.scrollDisp(1),C(t);e="\x1B[B";break;case 46:e="\x1B[3~";break;case 45:e="\x1B[2~";break;case 36:if(this.applicationKeypad){e="\x1BOH";break}e="\x1BOH";break;case 35:if(this.applicationKeypad){e="\x1BOF";break}e="\x1BOF";break;case 33:if(t.shiftKey)return this.scrollDisp(-(this.rows-1)),C(t);e="\x1B[5~";break;case 34:if(t.shiftKey)return this.scrollDisp(this.rows-1),C(t);e="\x1B[6~";break;case 112:e="\x1BOP";break;case 113:e="\x1BOQ";break;case 114:e="\x1BOR";break;case 115:e="\x1BOS";break;case 116:e="\x1B[15~";break;case 117:e="\x1B[17~";break;case 118:e="\x1B[18~";break;case 119:e="\x1B[19~";break;case 120:e="\x1B[20~";break;case 121:e="\x1B[21~";break;case 122:e="\x1B[23~";break;case 123:e="\x1B[24~";break;default:if(t.ctrlKey)if(t.keyCode>=65&&t.keyCode<=90){if(this.screenKeys&&!this.prefixMode&&!this.selectMode&&t.keyCode===65)return this.enterPrefix(),C(t);if(this.prefixMode&&t.keyCode===86){this.leavePrefix();return}if((this.prefixMode||this.selectMode)&&t.keyCode===67){this.visualMode&&A(function(){s.leaveVisual()},1);return}e=S.fromCharCode(t.keyCode-64)}else t.keyCode===32?e=S.fromCharCode(0):t.keyCode>=51&&t.keyCode<=55?e=S.fromCharCode(t.keyCode-51+27):t.keyCode===56?e=S.fromCharCode(127):t.keyCode===219?e=S.fromCharCode(27):t.keyCode===221&&(e=S.fromCharCode(29));else(!this.isMac&&t.altKey||this.isMac&&t.metaKey)&&(t.keyCode>=65&&t.keyCode<=90?e="\x1B"+S.fromCharCode(t.keyCode+32):t.keyCode===192?e="\x1B`":t.keyCode>=48&&t.keyCode<=57&&(e="\x1B"+(t.keyCode-48)));break}return e?this.prefixMode?(this.leavePrefix(),C(t)):this.selectMode?(this.keySelect(t,e),C(t)):(this.emit("keydown",t),this.emit("key",e,t),this.showCursor(),this.handler(e),C(t)):!0},h.prototype.setgLevel=function(t){this.glevel=t,this.charset=this.charsets[t]},h.prototype.setgCharset=function(t,s){this.charsets[t]=s,this.glevel===t&&(this.charset=s)},h.prototype.keyPress=function(t){var s;if(C(t),t.charCode)s=t.charCode;else if(t.which==null)s=t.keyCode;else if(t.which!==0&&t.charCode!==0)s=t.which;else return!1;return!s||t.ctrlKey||t.altKey||t.metaKey?!1:(s=S.fromCharCode(s),this.prefixMode?(this.leavePrefix(),this.keyPrefix(t,s),!1):this.selectMode?(this.keySelect(t,s),!1):(this.emit("keypress",s,t),this.emit("key",s,t),this.showCursor(),this.handler(s),!1))},h.prototype.send=function(t){var s=this;this.queue||A(function(){s.handler(s.queue),s.queue=""},1),this.queue+=t},h.prototype.bell=function(){if(this.emit("bell"),!!this.visualBell){var t=this;this.element.style.borderColor="white",A(function(){t.element.style.borderColor=""},10),this.popOnBell&&this.focus()}},h.prototype.log=function(){if(this.debug&&!(!this.context.console||!this.context.console.log)){var t=Array.prototype.slice.call(arguments);this.context.console.log.apply(this.context.console,t)}},h.prototype.error=function(){if(this.debug&&!(!this.context.console||!this.context.console.error)){var t=Array.prototype.slice.call(arguments);this.context.console.error.apply(this.context.console,t)}},h.prototype.resize=function(t,s){var e,r,l,a,n;if(t<1&&(t=1),s<1&&(s=1),a=this.cols,a<t)for(n=[this.defAttr," "],l=this.lines.length;l--;)for(;this.lines[l].length<t;)this.lines[l].push(n);else if(a>t)for(l=this.lines.length;l--;)for(;this.lines[l].length>t;)this.lines[l].pop();if(this.setupStops(a),this.cols=t,a=this.rows,a<s)for(r=this.element;a++<s;)this.lines.length<s+this.ybase&&this.lines.push(this.blankLine()),this.children.length<s&&(e=this.document.createElement("div"),r.appendChild(e),this.children.push(e));else if(a>s){for(;a-- >s;)if(this.lines.length>s+this.ybase&&this.lines.pop(),this.children.length>s){if(r=this.children.pop(),!r)continue;r.parentNode.removeChild(r)}}this.rows=s,this.y>=s&&(this.y=s-1),this.x>=t&&(this.x=t-1),this.scrollTop=0,this.scrollBottom=s-1,this.refresh(0,this.rows-1),this.normal=null},h.prototype.updateRange=function(t){t<this.refreshStart&&(this.refreshStart=t),t>this.refreshEnd&&(this.refreshEnd=t)},h.prototype.maxRange=function(){this.refreshStart=0,this.refreshEnd=this.rows-1},h.prototype.setupStops=function(t){for(t!=null?this.tabs[t]||(t=this.prevStop(t)):(this.tabs={},t=0);t<this.cols;t+=8)this.tabs[t]=!0},h.prototype.prevStop=function(t){for(t==null&&(t=this.x);!this.tabs[--t]&&t>0;);return t>=this.cols?this.cols-1:t<0?0:t},h.prototype.nextStop=function(t){for(t==null&&(t=this.x);!this.tabs[++t]&&t<this.cols;);return t>=this.cols?this.cols-1:t<0?0:t},h.prototype.eraseRight=function(t,s){for(var e=this.lines[this.ybase+s],r=[this.eraseAttr()," "];t<this.cols;t++)e[t]=r;this.updateRange(s)},h.prototype.eraseLeft=function(t,s){var e=this.lines[this.ybase+s],r=[this.eraseAttr()," "];for(t++;t--;)e[t]=r;this.updateRange(s)},h.prototype.eraseLine=function(t){this.eraseRight(0,t)},h.prototype.blankLine=function(t){for(var s=t?this.eraseAttr():this.defAttr,e=[s," "],r=[],l=0;l<this.cols;l++)r[l]=e;return r},h.prototype.ch=function(t){return t?[this.eraseAttr()," "]:[this.defAttr," "]},h.prototype.is=function(t){var s=this.termName;return(s+"").indexOf(t)===0},h.prototype.handler=function(t){this.emit("data",t)},h.prototype.handleTitle=function(t){this.emit("title",t)},h.prototype.index=function(){this.y++,this.y>this.scrollBottom&&(this.y--,this.scroll()),this.state=w},h.prototype.reverseIndex=function(){var t;this.y--,this.y<this.scrollTop&&(this.y++,this.lines.splice(this.y+this.ybase,0,this.blankLine(!0)),t=this.rows-1-this.scrollBottom,this.lines.splice(this.rows-1+this.ybase-t+1,1),this.updateRange(this.scrollTop),this.updateRange(this.scrollBottom)),this.state=w},h.prototype.reset=function(){this.options.rows=this.rows,this.options.cols=this.cols,h.call(this,this.options),this.refresh(0,this.rows-1)},h.prototype.tabSet=function(){this.tabs[this.x]=!0,this.state=w},h.prototype.cursorUp=function(t){var s=t[0];s<1&&(s=1),this.y-=s,this.y<0&&(this.y=0)},h.prototype.cursorDown=function(t){var s=t[0];s<1&&(s=1),this.y+=s,this.y>=this.rows&&(this.y=this.rows-1)},h.prototype.cursorForward=function(t){var s=t[0];s<1&&(s=1),this.x+=s,this.x>=this.cols&&(this.x=this.cols-1)},h.prototype.cursorBackward=function(t){var s=t[0];s<1&&(s=1),this.x-=s,this.x<0&&(this.x=0)},h.prototype.cursorPos=function(t){var s,e;s=t[0]-1,t.length>=2?e=t[1]-1:e=0,s<0?s=0:s>=this.rows&&(s=this.rows-1),e<0?e=0:e>=this.cols&&(e=this.cols-1),this.x=e,this.y=s},h.prototype.eraseInDisplay=function(t){var s;switch(t[0]){case 0:for(this.eraseRight(this.x,this.y),s=this.y+1;s<this.rows;s++)this.eraseLine(s);break;case 1:for(this.eraseLeft(this.x,this.y),s=this.y;s--;)this.eraseLine(s);break;case 2:for(s=this.rows;s--;)this.eraseLine(s);break;case 3:break}},h.prototype.eraseInLine=function(t){switch(t[0]){case 0:this.eraseRight(this.x,this.y);break;case 1:this.eraseLeft(this.x,this.y);break;case 2:this.eraseLine(this.y);break}},h.prototype.charAttributes=function(t){if(t.length===1&&t[0]===0){this.curAttr=this.defAttr;return}for(var s=t.length,e=0,r=this.curAttr>>18,l=this.curAttr>>9&511,a=this.curAttr&511,n;e<s;e++)n=t[e],n>=30&&n<=37?l=n-30:n>=40&&n<=47?a=n-40:n>=90&&n<=97?(n+=8,l=n-90):n>=100&&n<=107?(n+=8,a=n-100):n===0?(r=this.defAttr>>18,l=this.defAttr>>9&511,a=this.defAttr&511):n===1?r|=1:n===4?r|=2:n===5?r|=4:n===7?r|=8:n===8?r|=16:n===22?r&=-2:n===24?r&=-3:n===25?r&=-5:n===27?r&=-9:n===28?r&=-17:n===39?l=this.defAttr>>9&511:n===49?a=this.defAttr&511:n===38?t[e+1]===2?(e+=2,l=E(t[e]&255,t[e+1]&255,t[e+2]&255),l===-1&&(l=511),e+=2):t[e+1]===5&&(e+=2,n=t[e]&255,l=n):n===48?t[e+1]===2?(e+=2,a=E(t[e]&255,t[e+1]&255,t[e+2]&255),a===-1&&(a=511),e+=2):t[e+1]===5&&(e+=2,n=t[e]&255,a=n):n===100?(l=this.defAttr>>9&511,a=this.defAttr&511):this.error("Unknown SGR attribute: %d.",n);this.curAttr=r<<18|l<<9|a},h.prototype.deviceStatus=function(t){if(this.prefix){if(this.prefix==="?")switch(t[0]){case 6:this.send("\x1B[?"+(this.y+1)+";"+(this.x+1)+"R");break;case 15:break;case 25:break;case 26:break;case 53:break}}else switch(t[0]){case 5:this.send("\x1B[0n");break;case 6:this.send("\x1B["+(this.y+1)+";"+(this.x+1)+"R");break}},h.prototype.insertChars=function(t){var s,e,r,l;for(s=t[0],s<1&&(s=1),e=this.y+this.ybase,r=this.x,l=[this.eraseAttr()," "];s--&&r<this.cols;)this.lines[e].splice(r++,0,l),this.lines[e].pop()},h.prototype.cursorNextLine=function(t){var s=t[0];s<1&&(s=1),this.y+=s,this.y>=this.rows&&(this.y=this.rows-1),this.x=0},h.prototype.cursorPrecedingLine=function(t){var s=t[0];s<1&&(s=1),this.y-=s,this.y<0&&(this.y=0),this.x=0},h.prototype.cursorCharAbsolute=function(t){var s=t[0];s<1&&(s=1),this.x=s-1},h.prototype.insertLines=function(t){var s,e,r;for(s=t[0],s<1&&(s=1),e=this.y+this.ybase,r=this.rows-1-this.scrollBottom,r=this.rows-1+this.ybase-r+1;s--;)this.lines.splice(e,0,this.blankLine(!0)),this.lines.splice(r,1);this.updateRange(this.y),this.updateRange(this.scrollBottom)},h.prototype.deleteLines=function(t){var s,e,r;for(s=t[0],s<1&&(s=1),e=this.y+this.ybase,r=this.rows-1-this.scrollBottom,r=this.rows-1+this.ybase-r;s--;)this.lines.splice(r+1,0,this.blankLine(!0)),this.lines.splice(e,1);this.updateRange(this.y),this.updateRange(this.scrollBottom)},h.prototype.deleteChars=function(t){var s,e,r;for(s=t[0],s<1&&(s=1),e=this.y+this.ybase,r=[this.eraseAttr()," "];s--;)this.lines[e].splice(this.x,1),this.lines[e].push(r)},h.prototype.eraseChars=function(t){var s,e,r,l;for(s=t[0],s<1&&(s=1),e=this.y+this.ybase,r=this.x,l=[this.eraseAttr()," "];s--&&r<this.cols;)this.lines[e][r++]=l},h.prototype.charPosAbsolute=function(t){var s=t[0];s<1&&(s=1),this.x=s-1,this.x>=this.cols&&(this.x=this.cols-1)},h.prototype.HPositionRelative=function(t){var s=t[0];s<1&&(s=1),this.x+=s,this.x>=this.cols&&(this.x=this.cols-1)},h.prototype.sendDeviceAttributes=function(t){t[0]>0||(this.prefix?this.prefix===">"&&(this.is("xterm")?this.send("\x1B[>0;276;0c"):this.is("rxvt-unicode")?this.send("\x1B[>85;95;0c"):this.is("linux")?this.send(t[0]+"c"):this.is("screen")&&this.send("\x1B[>83;40003;0c")):this.is("xterm")||this.is("rxvt-unicode")||this.is("screen")?this.send("\x1B[?1;2c"):this.is("linux")&&this.send("\x1B[?6c"))},h.prototype.linePosAbsolute=function(t){var s=t[0];s<1&&(s=1),this.y=s-1,this.y>=this.rows&&(this.y=this.rows-1)},h.prototype.VPositionRelative=function(t){var s=t[0];s<1&&(s=1),this.y+=s,this.y>=this.rows&&(this.y=this.rows-1)},h.prototype.HVPosition=function(t){t[0]<1&&(t[0]=1),t[1]<1&&(t[1]=1),this.y=t[0]-1,this.y>=this.rows&&(this.y=this.rows-1),this.x=t[1]-1,this.x>=this.cols&&(this.x=this.cols-1)},h.prototype.setMode=function(t){if(typeof t=="object"){for(var s=t.length,e=0;e<s;e++)this.setMode(t[e]);return}if(this.prefix){if(this.prefix==="?")switch(t){case 1:this.applicationCursor=!0;break;case 2:this.setgCharset(0,h.charsets.US),this.setgCharset(1,h.charsets.US),this.setgCharset(2,h.charsets.US),this.setgCharset(3,h.charsets.US);break;case 3:this.savedCols=this.cols,this.resize(132,this.rows);break;case 6:this.originMode=!0;break;case 7:this.wraparoundMode=!0;break;case 12:break;case 66:this.log("Serial port requested application keypad."),this.applicationKeypad=!0;break;case 9:case 1e3:case 1002:case 1003:this.x10Mouse=t===9,this.vt200Mouse=t===1e3,this.normalMouse=t>1e3,this.mouseEvents=!0,this.element.style.cursor="default",this.log("Binding to mouse events.");break;case 1004:this.sendFocus=!0;break;case 1005:this.utfMouse=!0;break;case 1006:this.sgrMouse=!0;break;case 1015:this.urxvtMouse=!0;break;case 25:this.cursorHidden=!1;break;case 1049:case 47:case 1047:if(!this.normal){var r={lines:this.lines,ybase:this.ybase,ydisp:this.ydisp,x:this.x,y:this.y,scrollTop:this.scrollTop,scrollBottom:this.scrollBottom,tabs:this.tabs};this.reset(),this.normal=r,this.showCursor()}break}}else switch(t){case 4:this.insertMode=!0;break;case 20:break}},h.prototype.resetMode=function(t){if(typeof t=="object"){for(var s=t.length,e=0;e<s;e++)this.resetMode(t[e]);return}if(this.prefix){if(this.prefix==="?")switch(t){case 1:this.applicationCursor=!1;break;case 3:this.cols===132&&this.savedCols&&this.resize(this.savedCols,this.rows),delete this.savedCols;break;case 6:this.originMode=!1;break;case 7:this.wraparoundMode=!1;break;case 12:break;case 66:this.log("Switching back to normal keypad."),this.applicationKeypad=!1;break;case 9:case 1e3:case 1002:case 1003:this.x10Mouse=!1,this.vt200Mouse=!1,this.normalMouse=!1,this.mouseEvents=!1,this.element.style.cursor="";break;case 1004:this.sendFocus=!1;break;case 1005:this.utfMouse=!1;break;case 1006:this.sgrMouse=!1;break;case 1015:this.urxvtMouse=!1;break;case 25:this.cursorHidden=!0;break;case 1049:case 47:case 1047:this.normal&&(this.lines=this.normal.lines,this.ybase=this.normal.ybase,this.ydisp=this.normal.ydisp,this.x=this.normal.x,this.y=this.normal.y,this.scrollTop=this.normal.scrollTop,this.scrollBottom=this.normal.scrollBottom,this.tabs=this.normal.tabs,this.normal=null,this.refresh(0,this.rows-1),this.showCursor());break}}else switch(t){case 4:this.insertMode=!1;break;case 20:break}},h.prototype.setScrollRegion=function(t){this.prefix||(this.scrollTop=(t[0]||1)-1,this.scrollBottom=(t[1]||this.rows)-1,this.x=0,this.y=0)},h.prototype.saveCursor=function(t){this.savedX=this.x,this.savedY=this.y},h.prototype.restoreCursor=function(t){this.x=this.savedX||0,this.y=this.savedY||0},h.prototype.cursorForwardTab=function(t){for(var s=t[0]||1;s--;)this.x=this.nextStop()},h.prototype.scrollUp=function(t){for(var s=t[0]||1;s--;)this.lines.splice(this.ybase+this.scrollTop,1),this.lines.splice(this.ybase+this.scrollBottom,0,this.blankLine());this.updateRange(this.scrollTop),this.updateRange(this.scrollBottom)},h.prototype.scrollDown=function(t){for(var s=t[0]||1;s--;)this.lines.splice(this.ybase+this.scrollBottom,1),this.lines.splice(this.ybase+this.scrollTop,0,this.blankLine());this.updateRange(this.scrollTop),this.updateRange(this.scrollBottom)},h.prototype.initMouseTracking=function(t){},h.prototype.resetTitleModes=function(t){},h.prototype.cursorBackwardTab=function(t){for(var s=t[0]||1;s--;)this.x=this.prevStop()},h.prototype.repeatPrecedingCharacter=function(t){for(var s=t[0]||1,e=this.lines[this.ybase+this.y],r=e[this.x-1]||[this.defAttr," "];s--;)e[this.x++]=r},h.prototype.tabClear=function(t){var s=t[0];s<=0?delete this.tabs[this.x]:s===3&&(this.tabs={})},h.prototype.mediaCopy=function(t){},h.prototype.setResources=function(t){},h.prototype.disableModifiers=function(t){},h.prototype.setPointerMode=function(t){},h.prototype.softReset=function(t){this.cursorHidden=!1,this.insertMode=!1,this.originMode=!1,this.wraparoundMode=!1,this.applicationKeypad=!1,this.applicationCursor=!1,this.scrollTop=0,this.scrollBottom=this.rows-1,this.curAttr=this.defAttr,this.x=this.y=0,this.charset=null,this.glevel=0,this.charsets=[null]},h.prototype.requestAnsiMode=function(t){},h.prototype.requestPrivateMode=function(t){},h.prototype.setConformanceLevel=function(t){},h.prototype.loadLEDs=function(t){},h.prototype.setCursorStyle=function(t){},h.prototype.setCharProtectionAttr=function(t){},h.prototype.restorePrivateValues=function(t){},h.prototype.setAttrInRectangle=function(t){for(var s=t[0],e=t[1],r=t[2],l=t[3],a=t[4],n,u;s<r+1;s++)for(n=this.lines[this.ybase+s],u=e;u<l;u++)n[u]=[a,n[u][1]];this.updateRange(t[0]),this.updateRange(t[2])},h.prototype.savePrivateValues=function(t){},h.prototype.manipulateWindow=function(t){},h.prototype.reverseAttrInRectangle=function(t){},h.prototype.setTitleModeFeature=function(t){},h.prototype.setWarningBellVolume=function(t){},h.prototype.setMarginBellVolume=function(t){},h.prototype.copyRectangle=function(t){},h.prototype.enableFilterRectangle=function(t){},h.prototype.requestParameters=function(t){},h.prototype.selectChangeExtent=function(t){},h.prototype.fillRectangle=function(t){for(var s=t[0],e=t[1],r=t[2],l=t[3],a=t[4],n,u;e<l+1;e++)for(n=this.lines[this.ybase+e],u=r;u<a;u++)n[u]=[n[u][0],S.fromCharCode(s)];this.updateRange(t[1]),this.updateRange(t[3])},h.prototype.enableLocatorReporting=function(t){var s=t[0]>0},h.prototype.eraseRectangle=function(t){var s=t[0],e=t[1],r=t[2],l=t[3],a,n,u;for(u=[this.eraseAttr()," "];s<r+1;s++)for(a=this.lines[this.ybase+s],n=e;n<l;n++)a[n]=u;this.updateRange(t[0]),this.updateRange(t[2])},h.prototype.setLocatorEvents=function(t){},h.prototype.selectiveEraseRectangle=function(t){},h.prototype.requestLocatorPosition=function(t){},h.prototype.insertColumns=function(){for(var t=params[0],s=this.ybase+this.rows,e=[this.eraseAttr()," "],r;t--;)for(r=this.ybase;r<s;r++)this.lines[r].splice(this.x+1,0,e),this.lines[r].pop();this.maxRange()},h.prototype.deleteColumns=function(){for(var t=params[0],s=this.ybase+this.rows,e=[this.eraseAttr()," "],r;t--;)for(r=this.ybase;r<s;r++)this.lines[r].splice(this.x,1),this.lines[r].push(e);this.maxRange()},h.prototype.enterPrefix=function(){this.prefixMode=!0},h.prototype.leavePrefix=function(){this.prefixMode=!1},h.prototype.enterSelect=function(){this._real={x:this.x,y:this.y,ydisp:this.ydisp,ybase:this.ybase,cursorHidden:this.cursorHidden,lines:this.copyBuffer(this.lines),write:this.write},this.write=function(){},this.selectMode=!0,this.visualMode=!1,this.cursorHidden=!1,this.refresh(this.y,this.y)},h.prototype.leaveSelect=function(){this.x=this._real.x,this.y=this._real.y,this.ydisp=this._real.ydisp,this.ybase=this._real.ybase,this.cursorHidden=this._real.cursorHidden,this.lines=this._real.lines,this.write=this._real.write,delete this._real,this.selectMode=!1,this.visualMode=!1,this.refresh(0,this.rows-1)},h.prototype.enterVisual=function(){this._real.preVisual=this.copyBuffer(this.lines),this.selectText(this.x,this.x,this.ydisp+this.y,this.ydisp+this.y),this.visualMode=!0},h.prototype.leaveVisual=function(){this.lines=this._real.preVisual,delete this._real.preVisual,delete this._selected,this.visualMode=!1,this.refresh(0,this.rows-1)},h.prototype.enterSearch=function(t){this.entry="",this.searchMode=!0,this.searchDown=t,this._real.preSearch=this.copyBuffer(this.lines),this._real.preSearchX=this.x,this._real.preSearchY=this.y;for(var s=this.ydisp+this.rows-1,e=0;e<this.entryPrefix.length;e++)this.lines[s][e]=[this.defAttr&-512|4,this.entryPrefix[e]];this.y=this.rows-1,this.x=this.entryPrefix.length,this.refresh(this.rows-1,this.rows-1)},h.prototype.leaveSearch=function(){this.searchMode=!1,this._real.preSearch&&(this.lines=this._real.preSearch,this.x=this._real.preSearchX,this.y=this._real.preSearchY,delete this._real.preSearch,delete this._real.preSearchX,delete this._real.preSearchY),this.refresh(this.rows-1,this.rows-1)},h.prototype.copyBuffer=function(s){for(var s=s||this.lines,e=[],r=0;r<s.length;r++){e[r]=[];for(var l=0;l<s[r].length;l++)e[r][l]=[s[r][l][0],s[r][l][1]]}return e},h.prototype.getCopyTextarea=function(t){var s=this._copyTextarea,e=this.document;return s||(s=e.createElement("textarea"),s.style.position="absolute",s.style.left="-32000px",s.style.top="-32000px",s.style.width="0px",s.style.height="0px",s.style.opacity="0",s.style.backgroundColor="transparent",s.style.borderStyle="none",s.style.outlineStyle="none",e.getElementsByTagName("body")[0].appendChild(s),this._copyTextarea=s),s},h.prototype.copyText=function(t){var s=this,e=this.getCopyTextarea();this.emit("copy",t),e.focus(),e.textContent=t,e.value=t,e.setSelectionRange(0,t.length),A(function(){s.element.focus(),s.focus()},1)},h.prototype.selectText=function(t,s,e,r){var l,a,n,u,p,d,o,c,f;if(this._selected){for(l=this._selected.x1,a=this._selected.x2,n=this._selected.y1,u=this._selected.y2,u<n&&(p=a,a=l,l=p,p=u,u=n,n=p),a<l&&n===u&&(p=a,a=l,l=p),o=n;o<=u;o++)for(d=0,c=this.cols-1,o===n&&(d=l),o===u&&(c=a);d<=c;d++)this.lines[o][d].old!=null&&(f=this.lines[o][d].old,delete this.lines[o][d].old,this.lines[o][d]=[f,this.lines[o][d][1]]);e=this._selected.y1,t=this._selected.x1}for(e=Math.max(e,0),e=Math.min(e,this.ydisp+this.rows-1),r=Math.max(r,0),r=Math.min(r,this.ydisp+this.rows-1),this._selected={x1:t,x2:s,y1:e,y2:r},r<e&&(p=s,s=t,t=p,p=r,r=e,e=p),s<t&&e===r&&(p=s,s=t,t=p),o=e;o<=r;o++)for(d=0,c=this.cols-1,o===e&&(d=t),o===r&&(c=s);d<=c;d++)f=this.lines[o][d][0],this.lines[o][d]=[f&-512|261636,this.lines[o][d][1]],this.lines[o][d].old=f;e=e-this.ydisp,r=r-this.ydisp,e=Math.max(e,0),e=Math.min(e,this.rows-1),r=Math.max(r,0),r=Math.min(r,this.rows-1),this.refresh(0,this.rows-1)},h.prototype.grabText=function(t,s,e,r){var l="",a="",n,u,p,d,o;for(r<e&&(o=s,s=t,t=o,o=r,r=e,e=o),s<t&&e===r&&(o=s,s=t,t=o),p=e;p<=r;p++){for(u=0,d=this.cols-1,p===e&&(u=t),p===r&&(d=s);u<=d;u++){if(n=this.lines[p][u][1],n===" "){a+=n;continue}a&&(l+=a,a=""),l+=n,O(n)&&u++}a="",l+=`
`}for(u=s,p=r;u<this.cols;u++)if(this.lines[p][u][1]!==" "){l=l.slice(0,-1);break}return l},h.prototype.keyPrefix=function(t,s){s==="k"||s==="&"?this.destroy():s==="p"||s==="]"?this.emit("request paste"):s==="c"?this.emit("request create"):s>="0"&&s<="9"?(s=+s-1,~s||(s=9),this.emit("request term",s)):s==="n"?this.emit("request term next"):s==="P"?this.emit("request term previous"):s===":"?this.emit("request command mode"):s==="["&&this.enterSelect()},h.prototype.keySelect=function(t,s){if(this.showCursor(),this.searchMode||s==="n"||s==="N")return this.keySearch(t,s);if(s===""){var e=this.ydisp+this.y;this.ydisp===this.ybase?(this.y=Math.min(this.y+(this.rows-1)/2|0,this.rows-1),this.refresh(0,this.rows-1)):this.scrollDisp((this.rows-1)/2|0),this.visualMode&&this.selectText(this.x,this.x,e,this.ydisp+this.y);return}if(s===""){var e=this.ydisp+this.y;this.ydisp===0?(this.y=Math.max(this.y-(this.rows-1)/2|0,0),this.refresh(0,this.rows-1)):this.scrollDisp(-(this.rows-1)/2|0),this.visualMode&&this.selectText(this.x,this.x,e,this.ydisp+this.y);return}if(s===""){var e=this.ydisp+this.y;this.scrollDisp(this.rows-1),this.visualMode&&this.selectText(this.x,this.x,e,this.ydisp+this.y);return}if(s===""){var e=this.ydisp+this.y;this.scrollDisp(-(this.rows-1)),this.visualMode&&this.selectText(this.x,this.x,e,this.ydisp+this.y);return}if(s==="k"||s==="\x1B[A"){var e=this.ydisp+this.y;this.y--,this.y<0&&(this.y=0,this.scrollDisp(-1)),this.visualMode?this.selectText(this.x,this.x,e,this.ydisp+this.y):this.refresh(this.y,this.y+1);return}if(s==="j"||s==="\x1B[B"){var e=this.ydisp+this.y;this.y++,this.y>=this.rows&&(this.y=this.rows-1,this.scrollDisp(1)),this.visualMode?this.selectText(this.x,this.x,e,this.ydisp+this.y):this.refresh(this.y-1,this.y);return}if(s==="h"||s==="\x1B[D"){var r=this.x;this.x--,this.x<0&&(this.x=0),this.visualMode?this.selectText(r,this.x,this.ydisp+this.y,this.ydisp+this.y):this.refresh(this.y,this.y);return}if(s==="l"||s==="\x1B[C"){var r=this.x;this.x++,this.x>=this.cols&&(this.x=this.cols-1),this.visualMode?this.selectText(r,this.x,this.ydisp+this.y,this.ydisp+this.y):this.refresh(this.y,this.y);return}if(s==="v"||s===" "){this.visualMode?this.leaveVisual():this.enterVisual();return}if(s==="y"){if(this.visualMode){var l=this.grabText(this._selected.x1,this._selected.x2,this._selected.y1,this._selected.y2);this.copyText(l),this.leaveVisual()}return}if(s==="q"||s==="\x1B"){this.visualMode?this.leaveVisual():this.leaveSelect();return}if(s==="w"||s==="W"){for(var a=this.x,n=this.y,u=this.ydisp,r=this.x,e=this.y,p=this.ydisp,d=!1;;){for(var o=this.lines[p+e];r<this.cols;){if(o[r][1]<=" ")d=!0;else if(d)break;r++}if(r>=this.cols&&(r=this.cols-1),r===this.cols-1&&o[r][1]<=" "){if(r=0,++e>=this.rows&&(e--,++p>this.ybase)){p=this.ybase,r=this.x;break}continue}break}this.x=r,this.y=e,this.scrollDisp(-this.ydisp+p),this.visualMode&&this.selectText(a,this.x,n+u,this.ydisp+this.y);return}if(s==="b"||s==="B"){for(var a=this.x,n=this.y,u=this.ydisp,r=this.x,e=this.y,p=this.ydisp;;){for(var o=this.lines[p+e],d=r>0&&o[r][1]>" "&&o[r-1][1]>" ";r>=0;){if(o[r][1]<=" ")if(d&&r+1<this.cols&&o[r+1][1]>" "){r++;break}else d=!0;r--}if(r<0&&(r=0),r===0&&(o[r][1]<=" "||!d)){if(r=this.cols-1,--e<0&&(e++,--p<0)){p++,r=0;break}continue}break}this.x=r,this.y=e,this.scrollDisp(-this.ydisp+p),this.visualMode&&this.selectText(a,this.x,n+u,this.ydisp+this.y);return}if(s==="e"||s==="E"){var r=this.x+1,e=this.y,p=this.ydisp;for(r>=this.cols&&r--;;){for(var o=this.lines[p+e];r<this.cols&&o[r][1]<=" ";)r++;for(;r<this.cols;){if(o[r][1]<=" "&&r-1>=0&&o[r-1][1]>" "){r--;break}r++}if(r>=this.cols&&(r=this.cols-1),r===this.cols-1&&o[r][1]<=" "){if(r=0,++e>=this.rows&&(e--,++p>this.ybase)){p=this.ybase;break}continue}break}this.x=r,this.y=e,this.scrollDisp(-this.ydisp+p),this.visualMode&&this.selectText(a,this.x,n+u,this.ydisp+this.y);return}if(s==="^"||s==="0"){var a=this.x;if(s==="0")this.x=0;else if(s==="^"){for(var o=this.lines[this.ydisp+this.y],r=0;r<this.cols&&!(o[r][1]>" ");)r++;r>=this.cols&&(r=this.cols-1),this.x=r}this.visualMode?this.selectText(a,this.x,this.ydisp+this.y,this.ydisp+this.y):this.refresh(this.y,this.y);return}if(s==="$"){for(var a=this.x,o=this.lines[this.ydisp+this.y],r=this.cols-1;r>=0;){if(o[r][1]>" "){this.visualMode&&r<this.cols-1&&r++;break}r--}r<0&&(r=0),this.x=r,this.visualMode?this.selectText(a,this.x,this.ydisp+this.y,this.ydisp+this.y):this.refresh(this.y,this.y);return}if(s==="g"||s==="G"){var a=this.x,n=this.y,u=this.ydisp;s==="g"?(this.x=0,this.y=0,this.scrollDisp(-this.ydisp)):s==="G"&&(this.x=0,this.y=this.rows-1,this.scrollDisp(this.ybase)),this.visualMode&&this.selectText(a,this.x,n+u,this.ydisp+this.y);return}if(s==="H"||s==="M"||s==="L"){var a=this.x,n=this.y;s==="H"?(this.x=0,this.y=0):s==="M"?(this.x=0,this.y=this.rows/2|0):s==="L"&&(this.x=0,this.y=this.rows-1),this.visualMode?this.selectText(a,this.x,this.ydisp+n,this.ydisp+this.y):(this.refresh(n,n),this.refresh(this.y,this.y));return}if(s==="{"||s==="}"){var a=this.x,n=this.y,u=this.ydisp,o,c=!1,f=!1,g=-1,e=this.y+(s==="{"?-1:1),p=this.ydisp,k;for(s==="{"?e<0&&(e++,p>0&&p--):s==="}"&&e>=this.rows&&(e--,p<this.ybase&&p++);;){for(o=this.lines[p+e],k=0;k<this.cols;k++)if(o[k][1]>" "){g===-1&&(g=0),c=!0;break}else if(k===this.cols-1){g===-1?g=1:(g===0||g===1&&c)&&(f=!0);break}if(f)break;if(s==="{"){if(e--,e<0)if(e++,p>0)p--;else break}else if(s==="}"&&(e++,e>=this.rows))if(e--,p<this.ybase)p++;else break}f||(s==="{"?(e=0,p=0):s==="}"&&(e=this.rows-1,p=this.ybase)),this.x=0,this.y=e,this.scrollDisp(-this.ydisp+p),this.visualMode&&this.selectText(a,this.x,n+u,this.ydisp+this.y);return}if(s==="/"||s==="?"){this.visualMode||this.enterSearch(s==="/");return}return!1},h.prototype.keySearch=function(t,s){if(s==="\x1B"){this.leaveSearch();return}if(s==="\r"||!this.searchMode&&(s==="n"||s==="N")){this.leaveSearch();var e=this.entry;if(!e){this.refresh(0,this.rows-1);return}for(var r=this.x,l=this.y,a=this.ydisp,n,u=!1,p=!1,d=this.x+1,o=this.ydisp+this.y,c,f,g=s==="N"?this.searchDown:!this.searchDown;;){for(n=this.lines[o];d<this.cols;){for(f=0;f<e.length&&!(d+f>=this.cols||n[d+f][1]!==e[f]);f++)if(n[d+f][1]===e[f]&&f===e.length-1){u=!0;break}if(u)break;d+=f+1}if(u)break;if(d=0,g){if(o--,o<0){if(p)break;p=!0,o=this.ybase+this.rows-1}}else if(o++,o>this.ybase+this.rows-1){if(p)break;p=!0,o=0}}if(u){o-this.ybase<0?(c=o,o=0,c>this.ybase&&(o=c-this.ybase,c=this.ybase)):(c=this.ybase,o-=this.ybase),this.x=d,this.y=o,this.scrollDisp(-this.ydisp+c),this.visualMode&&this.selectText(r,this.x,l+a,this.ydisp+this.y);return}this.refresh(0,this.rows-1);return}if(s==="\b"||s==="\x7F"){if(this.entry.length===0)return;var k=this.ydisp+this.rows-1;this.entry=this.entry.slice(0,-1);var f=this.entryPrefix.length+this.entry.length;this.lines[k][f]=[this.lines[k][f][0]," "],this.x--,this.refresh(this.rows-1,this.rows-1),this.refresh(this.y,this.y);return}if(s.length===1&&s>=" "&&s<="~"){var k=this.ydisp+this.rows-1;this.entry+=s;var f=this.entryPrefix.length+this.entry.length-1;this.lines[k][f]=[this.defAttr&-512|4,s],this.x++,this.refresh(this.rows-1,this.rows-1),this.refresh(this.y,this.y);return}return!1},h.prototype.exportState=function(){return JSON.stringify({rows:this.rows,cols:this.cols,ybase:this.ybase,ydisp:this.ydisp,x:this.x,y:this.y,cursorState:this.cursorState,cursorHidden:this.cursorHidden,convertEol:this.convertEol,state:this.state,queue:this.queue,scrollTop:this.scrollTop,scrollBottom:this.scrollBottom,applicationKeypad:this.applicationKeypad,applicationCursor:this.applicationCursor,originMode:this.originMode,insertMode:this.insertMode,wraparoundMode:this.wraparoundMode,normal:this.normal,prefixMode:this.prefixMode,selectMode:this.selectMode,visualMode:this.visualMode,searchMode:this.searchMode,searchDown:this.searchDown,entry:this.entry,_real:this._real,_selected:this._selected,charset:this.charset,gcharset:this.gcharset,glevel:this.glevel,charsets:this.charsets,decLocator:this.decLocator,x10Mouse:this.x10Mouse,vt200Mouse:this.vt200Mouse,vt300Mouse:this.vt300Mouse,normalMouse:this.normalMouse,mouseEvents:this.mouseEvents,sendFocus:this.sendFocus,utfMouse:this.utfMouse,sgrMouse:this.sgrMouse,urxvtMouse:this.urxvtMouse,refreshStart:this.refreshStart,refreshEnd:this.refreshEnd,savedX:this.savedX,savedY:this.savedY,savedCols:this.savedCols,curAttr:this.curAttr,params:this.params,currentParam:this.currentParam,prefix:this.prefix,postfix:this.postfix,lines:this.lines,tabs:this.tabs})},h.prototype.importState=function(t){var s=JSON.parse(t);this.reset(),this.rows=s.rows,this.cols=s.cols,this.ybase=s.ybase,this.ydisp=s.ydisp,this.x=s.x,this.y=s.y,this.cursorState=s.cursorState,this.cursorHidden=s.cursorHidden,this.convertEol=s.convertEol,this.state=s.state,this.queue=s.queue,this.scrollTop=s.scrollTop,this.scrollBottom=s.scrollBottom,this.applicationKeypad=s.applicationKeypad,this.applicationCursor=s.applicationCursor,this.originMode=s.originMode,this.insertMode=s.insertMode,this.wraparoundMode=s.wraparoundMode,this.normal=s.normal,this.prefixMode=s.prefixMode,this.selectMode=s.selectMode,this.visualMode=s.visualMode,this.searchMode=s.searchMode,this.searchDown=s.searchDown,this.entry=s.entry,this._real=s._real,this._selected=s._selected,this.charset=s.charset,this.gcharset=s.gcharset,this.glevel=s.glevel,this.charsets=s.charsets,this.decLocator=s.decLocator,this.x10Mouse=s.x10Mouse,this.vt200Mouse=s.vt200Mouse,this.vt300Mouse=s.vt300Mouse,this.normalMouse=s.normalMouse,this.mouseEvents=s.mouseEvents,this.sendFocus=s.sendFocus,this.utfMouse=s.utfMouse,this.sgrMouse=s.sgrMouse,this.urxvtMouse=s.urxvtMouse,this.refreshStart=s.refreshStart,this.refreshEnd=s.refreshEnd,this.savedX=s.savedX,this.savedY=s.savedY,this.savedCols=s.savedCols,this.curAttr=s.curAttr,this.params=s.params,this.currentParam=s.currentParam,this.prefix=s.prefix,this.postfix=s.postfix,this.lines=s.lines,this.tabs=s.tabs,this.refresh(0,this.rows-1)},h.charsets={},h.charsets.SCLD={"`":"\u25C6",a:"\u2592",b:"	",c:"\f",d:"\r",e:`
`,f:"\xB0",g:"\xB1",h:"\u2424",i:"\v",j:"\u2518",k:"\u2510",l:"\u250C",m:"\u2514",n:"\u253C",o:"\u23BA",p:"\u23BB",q:"\u2500",r:"\u23BC",s:"\u23BD",t:"\u251C",u:"\u2524",v:"\u2534",w:"\u252C",x:"\u2502",y:"\u2264",z:"\u2265","{":"\u03C0","|":"\u2260","}":"\xA3","~":"\xB7"},h.charsets.UK=null,h.charsets.US=null,h.charsets.Dutch=null,h.charsets.Finnish=null,h.charsets.French=null,h.charsets.FrenchCanadian=null,h.charsets.German=null,h.charsets.Italian=null,h.charsets.NorwegianDanish=null,h.charsets.Spanish=null,h.charsets.Swedish=null,h.charsets.Swiss=null,h.charsets.ISOLatin=null;function B(t,s,e,r){t.addEventListener(s,e,r||!1)}function R(t,s,e,r){t.removeEventListener(s,e,r||!1)}function C(t){return t.preventDefault&&t.preventDefault(),t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,!1}function N(t,s){function e(){this.constructor=t}e.prototype=s.prototype,t.prototype=new e}function st(t){var s=t.getElementsByTagName("body")[0],e=t.createElement("span");e.innerHTML="hello world",s.appendChild(e);var r=e.scrollWidth;e.style.fontWeight="bold";var l=e.scrollWidth;return s.removeChild(e),r!==l}var S=this.String,A=this.setTimeout,U=this.setInterval;function et(t,s){for(var e=t.length;e--;)if(t[e]===s)return e;return-1}function O(t){return t<="\uFF00"?!1:t>="\uFF01"&&t<="\uFFBE"||t>="\uFFC2"&&t<="\uFFC7"||t>="\uFFCA"&&t<="\uFFCF"||t>="\uFFD2"&&t<="\uFFD7"||t>="\uFFDA"&&t<="\uFFDC"||t>="\uFFE0"&&t<="\uFFE6"||t>="\uFFE8"&&t<="\uFFEE"}function E(t,s,e){var r=t<<16|s<<8|e;if(E._cache[r]!=null)return E._cache[r];for(var l=1/0,a=-1,n=0,u,p,d,o,c;n<h.vcolors.length;n++){if(u=h.vcolors[n],p=u[0],d=u[1],o=u[2],c=E.distance(t,s,e,p,d,o),c===0){a=n;break}c<l&&(l=c,a=n)}return E._cache[r]=a}E._cache={},E.distance=function(t,s,e,r,l,a){return Math.pow(30*(t-r),2)+Math.pow(59*(s-l),2)+Math.pow(11*(e-a),2)};function V(t,s,e){if(t.forEach)return t.forEach(s,e);for(var r=0;r<t.length;r++)s.call(e,t[r],r,t)}function j(t){if(Object.keys)return Object.keys(t);var s,e=[];for(s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.push(s);return e}h.EventEmitter=m,h.inherits=N,h.on=B,h.off=R,h.cancel=C,typeof b<"u"?b.exports=h:this.Terminal=h}).call(function(){return this||(typeof window<"u"?window:global)}())}});function T(){this._chunks=null,this._frame=0,this._startTime=null,this._tickHandle=null,this.listeners=[]}T.prototype.load=function(y){this._chunks=y,this.rewind()},T.prototype.addListener=function(y){this.listeners.push(y)},T.prototype.removeListener=function(y){this.listeners=this.listeners.filter(function(b){return y!==b})},T.prototype.play=function(){return this._tickHandle||this._frame>=this._chunks.length?!0:(this._emit("play"),this._step(),!1)},T.prototype._emit=function(b,x){this.listeners.forEach(function(v){try{v({type:b,data:x})}catch(m){setTimeout(function(){throw m},0)}}.bind(this))},T.prototype.pause=function(){this._tickHandle&&(this._emit("pause"),clearTimeout(this._tickHandle),this._tickHandle=null,this._startTime=null)},T.prototype.rewind=function(){this.pause(),this._emit("rewind"),this._frame=0},T.prototype._step=function(){var b;this._startTime===null?(this._startTime=new Date().getTime()-this._chunks[this._frame].ms,b=this._startTime):b=new Date().getTime();var x=[],v=this._frame,m;for(i=this._frame;i<this._chunks.length&&this._chunks[i].ms<=b-this._startTime;++i)x.push(this._chunks[i]);if(this._frame=i,x.forEach(function(_){this._emit("data",{data:_.data,frame:v,ms:_.ms})}.bind(this)),this._frame<this._chunks.length){var w=this._chunks[i].ms-b;this._tickHandle=setTimeout(this._step.bind(this),w)}else this._emit("end")};function Q(y){for(var b="",x=0;x<y.length;++x){var v=y[x],m;if(v&128){if(m=0,y[x]&64)if(!(y[x]&32))m=1,v=y[x]&31;else if(!(y[x]&16))m=2,v=y[x]&15;else if(!(y[x]&8))m=3,v=y[x]&7;else throw new Error("Bad UTF-8 Sequence: more than 6 additional chars");else throw new Error("Bad UTF-8 Sequence: mismatch");for(var w=0;w<m;++w){if(x++,x>=y.length)throw new Error("Bad UTF-8 Sequence: need more data");v=v<<6|y[x]&63}if(v>1114111)throw new Error("Bad UTF-8 Sequence: code point too large");if(v>65535){var _=v-65536,D=55296+((_&1047552)>>10),P=56320+(_&1023);b+=String.fromCharCode(D)+String.fromCharCode(P)}else b+=String.fromCharCode(v)}else b+=String.fromCharCode(v)}return b}function q(){}q.prototype.parse=function(y){for(var b=[],x=null,v=0;v<y.byteLength;){var m=new Uint32Array(y.slice(v+0,v+12)),w=m[0],_=m[1],D=m[2],P;x===null?(x=w*1e3+_/1e3,P=0):P=w*1e3+_/1e3-x,v+=12;var L=Q(new Uint8Array(y.slice(v+0,v+D)));v+=D,b.push({ms:P,data:L})}return b};var tt=J(Z()),it={Parser:q,Player:T,Terminal:tt.Terminal}})();})();
