(()=>{(()=>{var j=Object.create,O=Object.defineProperty,Y=Object.getOwnPropertyDescriptor,K=Object.getOwnPropertyNames,X=Object.getPrototypeOf,G=Object.prototype.hasOwnProperty,W=(d,y)=>function(){return y||(0,d[K(d)[0]])((y={exports:{}}).exports,y),y.exports},z=(d,y,m,v)=>{if(y&&typeof y=="object"||typeof y=="function")for(let b of K(y))!G.call(d,b)&&b!==m&&O(d,b,{get:()=>y[b],enumerable:!(v=Y(y,b))||v.enumerable});return d},$=(d,y,m)=>(m=d!=null?j(X(d)):{},z(y||!d||!d.__esModule?O(m,"default",{value:d,enumerable:!0}):m,d)),J=W({"ext/term.cjs"(d,y){(function(){"use strict";var m=this,v=this.document;function b(){this._events=this._events||{}}b.prototype.addListener=function(t,s){this._events[t]=this._events[t]||[],this._events[t].push(s)},b.prototype.on=b.prototype.addListener,b.prototype.removeListener=function(t,s){if(this._events[t]){for(var e=this._events[t],i=e.length;i--;)if(e[i]===s||e[i].listener===s){e.splice(i,1);return}}},b.prototype.off=b.prototype.removeListener,b.prototype.removeAllListeners=function(t){this._events[t]&&delete this._events[t]},b.prototype.once=function(t,s){function e(){var i=Array.prototype.slice.call(arguments);return this.removeListener(t,e),s.apply(this,i)}return e.listener=s,this.on(t,e)},b.prototype.emit=function(t){if(this._events[t])for(var s=Array.prototype.slice.call(arguments,1),e=this._events[t],i=e.length,n=0;n<i;n++)e[n].apply(this,s)},b.prototype.listeners=function(t){return this._events[t]=this._events[t]||[]};var x=0,_=1,S=2,P=3,D=4,q=5,L=6;function r(t){var s=this;if(!(this instanceof r))return new r(arguments[0],arguments[1],arguments[2]);b.call(this),typeof t=="number"&&(t={cols:arguments[0],rows:arguments[1],handler:arguments[2]}),t=t||{},U(V(r.defaults),function(i){t[i]==null&&(t[i]=r.options[i],r[i]!==r.defaults[i]&&(t[i]=r[i])),s[i]=t[i]}),t.colors.length===8?t.colors=t.colors.concat(r._colors.slice(8)):t.colors.length===16?t.colors=t.colors.concat(r._colors.slice(16)):t.colors.length===10?t.colors=t.colors.slice(0,-2).concat(r._colors.slice(8,-2),t.colors.slice(-2)):t.colors.length===18&&(t.colors=t.colors.slice(0,-2).concat(r._colors.slice(16,-2),t.colors.slice(-2))),this.colors=t.colors,this.options=t,this.parent=t.body||t.parent||(v?v.getElementsByTagName("body")[0]:null),this.cols=t.cols||t.geometry[0],this.rows=t.rows||t.geometry[1],t.handler&&this.on("data",t.handler),this.ybase=0,this.ydisp=0,this.x=0,this.y=0,this.cursorState=0,this.cursorHidden=!1,this.convertEol,this.state=0,this.queue="",this.scrollTop=0,this.scrollBottom=this.rows-1,this.applicationKeypad=!1,this.applicationCursor=!1,this.originMode=!1,this.insertMode=!1,this.wraparoundMode=!1,this.normal=null,this.prefixMode=!1,this.selectMode=!1,this.visualMode=!1,this.searchMode=!1,this.searchDown,this.entry="",this.entryPrefix="Search: ",this._real,this._selected,this._textarea,this.charset=null,this.gcharset=null,this.glevel=0,this.charsets=[null],this.decLocator,this.x10Mouse,this.vt200Mouse,this.vt300Mouse,this.normalMouse,this.mouseEvents,this.sendFocus,this.utfMouse,this.sgrMouse,this.urxvtMouse,this.element,this.children,this.refreshStart,this.refreshEnd,this.savedX,this.savedY,this.savedCols,this.readable=!0,this.writable=!0,this.defAttr=131840,this.curAttr=this.defAttr,this.params=[],this.currentParam=0,this.prefix="",this.postfix="",this.lines=[];for(var e=this.rows;e--;)this.lines.push(this.blankLine());this.tabs,this.setupStops()}I(r,b),r.prototype.eraseAttr=function(){return this.defAttr&-512|this.curAttr&511},r.tangoColors=["#2e3436","#cc0000","#4e9a06","#c4a000","#3465a4","#75507b","#06989a","#d3d7cf","#555753","#ef2929","#8ae234","#fce94f","#729fcf","#ad7fa8","#34e2e2","#eeeeec"],r.xtermColors=["#000000","#cd0000","#00cd00","#cdcd00","#0000ee","#cd00cd","#00cdcd","#e5e5e5","#7f7f7f","#ff0000","#00ff00","#ffff00","#5c5cff","#ff00ff","#00ffff","#ffffff"],r.colors=function(){var t=r.tangoColors.slice(),s=[0,95,135,175,215,255],e;for(e=0;e<216;e++)i(s[e/36%6|0],s[e/6%6|0],s[e%6]);for(e=0;e<24;e++)s=8+e*10,i(s,s,s);function i(h,o,f){t.push("#"+n(h)+n(o)+n(f))}function n(h){return h=h.toString(16),h.length<2?"0"+h:h}return t}(),r.colors[256]="#000000",r.colors[257]="#f0f0f0",r._colors=r.colors.slice(),r.vcolors=function(){for(var t=[],s=r.colors,e=0,i;e<256;e++)i=parseInt(s[e].substring(1),16),t.push([i>>16&255,i>>8&255,i&255]);return t}(),r.defaults={colors:r.colors,convertEol:!1,termName:"xterm",geometry:[80,24],cursorBlink:!0,visualBell:!1,popOnBell:!1,scrollback:1e3,screenKeys:!1,debug:!1,useStyle:!1},r.options={},U(V(r.defaults),function(t){r[t]=r.defaults[t],r.options[t]=r.defaults[t]}),r.focus=null,r.prototype.focus=function(){r.focus!==this&&(r.focus&&r.focus.blur(),this.sendFocus&&this.send("\x1B[I"),this.showCursor(),r.focus=this)},r.prototype.blur=function(){r.focus===this&&(this.cursorState=0,this.refresh(this.y,this.y),this.sendFocus&&this.send("\x1B[O"),r.focus=null)},r.prototype.initGlobal=function(){var t=this.document;r._boundDocs=r._boundDocs||[],!~st(r._boundDocs,t)&&(r._boundDocs.push(t),r.bindPaste(t),r.bindKeys(t),r.bindCopy(t),this.isMobile&&this.fixMobile(t),this.useStyle&&r.insertStyle(t,this.colors[256],this.colors[257]))},r.bindPaste=function(t){var s=t.defaultView;C(s,"paste",function(e){var i=r.focus;if(i)return e.clipboardData?i.send(e.clipboardData.getData("text/plain")):i.context.clipboardData&&i.send(i.context.clipboardData.getData("Text")),i.element.contentEditable="inherit",M(e)})},r.bindKeys=function(t){C(t,"keydown",function(s){if(r.focus){var e=s.target||s.srcElement;if(e&&(e===r.focus.element||e===r.focus.context||e===r.focus.document||e===r.focus.body||e===r._textarea||e===r.focus.parent))return r.focus.keyDown(s)}},!0),C(t,"keypress",function(s){if(r.focus){var e=s.target||s.srcElement;if(e&&(e===r.focus.element||e===r.focus.context||e===r.focus.document||e===r.focus.body||e===r._textarea||e===r.focus.parent))return r.focus.keyPress(s)}},!0),C(t,"mousedown",function(s){if(r.focus){var e=s.target||s.srcElement;if(e){do if(e===r.focus.element)return;while(e=e.parentNode);r.focus.blur()}}})},r.bindCopy=function(t){var s=t.defaultView;C(s,"copy",function(e){var i=r.focus;if(i&&i._selected){var n=i.getCopyTextarea(),h=i.grabText(i._selected.x1,i._selected.x2,i._selected.y1,i._selected.y2);i.emit("copy",h),n.focus(),n.textContent=h,n.value=h,n.setSelectionRange(0,h.length),A(function(){i.element.focus(),i.focus()},1)}})},r.prototype.fixMobile=function(t){var s=this,e=t.createElement("textarea");e.style.position="absolute",e.style.left="-32000px",e.style.top="-32000px",e.style.width="0px",e.style.height="0px",e.style.opacity="0",e.style.backgroundColor="transparent",e.style.borderStyle="none",e.style.outlineStyle="none",e.autocapitalize="none",e.autocorrect="off",t.getElementsByTagName("body")[0].appendChild(e),r._textarea=e,A(function(){e.focus()},1e3),this.isAndroid&&C(e,"change",function(){var i=e.textContent||e.value;e.value="",e.textContent="",s.send(i+"\r")})},r.insertStyle=function(t,s,e){var n=t.getElementById("term-style");if(!n){var i=t.getElementsByTagName("head")[0];if(i){var n=t.createElement("style");n.id="term-style",n.innerHTML=`.terminal {
  float: left;
  border: `+s+` solid 5px;
  font-family: "DejaVu Sans Mono", "Liberation Mono", monospace;
  font-size: 11px;
  color: `+e+`;
  background: `+s+`;
}

.terminal-cursor {
  color: `+s+`;
  background: `+e+`;
}
`,i.insertBefore(n,i.firstChild)}}},r.prototype.open=function(t){var s=this,e=0,i;if(this.parent=t||this.parent,!this.parent)throw new Error("Terminal requires a parent element.");for(this.context=this.parent.ownerDocument.defaultView,this.document=this.parent.ownerDocument,this.body=this.document.getElementsByTagName("body")[0],this.context.navigator&&this.context.navigator.userAgent&&(this.isMac=!!~this.context.navigator.userAgent.indexOf("Mac"),this.isIpad=!!~this.context.navigator.userAgent.indexOf("iPad"),this.isIphone=!!~this.context.navigator.userAgent.indexOf("iPhone"),this.isAndroid=!!~this.context.navigator.userAgent.indexOf("Android"),this.isMobile=this.isIpad||this.isIphone||this.isAndroid,this.isMSIE=!!~this.context.navigator.userAgent.indexOf("MSIE")),this.element=this.document.createElement("div"),this.element.className="terminal",this.element.style.outline="none",this.element.setAttribute("tabindex",0),this.element.setAttribute("spellcheck","false"),this.element.style.backgroundColor=this.colors[256],this.element.style.color=this.colors[257],this.children=[];e<this.rows;e++)i=this.document.createElement("div"),this.element.appendChild(i),this.children.push(i);this.parent.appendChild(this.element),this.refresh(0,this.rows-1),this.options.noEvents&&this.initGlobal(),this.options.noFocus||(this.focus(),this.startBlink(),C(this.element,"focus",function(){s.focus(),s.isMobile&&r._textarea.focus()}),C(this.element,"mousedown",function(){s.focus()}),C(this.element,"mousedown",function(n){var h=n.button!=null?+n.button:n.which!=null?n.which-1:null;s.isMSIE&&(h=h===1?0:h===4?1:h),h===2&&(s.element.contentEditable="true",A(function(){s.element.contentEditable="inherit"},1))},!0)),this.options.noMouse&&this.bindMouse(),this.options.noFocus||A(function(){s.element.focus()},100),r.brokenBold==null&&(r.brokenBold=tt(this.document))},r.prototype.bindMouse=function(){var t=this.element,s=this,e=32,i="onmousewheel"in this.context?"mousewheel":"DOMMouseScroll";function n(a){var l,c;if(l=u(a),c=p(a),!!c)switch(f(l,c),a.type){case"mousedown":e=l;break;case"mouseup":e=32;break;case i:break}}function h(a){var l=e,c;c=p(a),c&&(l+=32,f(l,c))}function o(a,l){if(s.utfMouse){if(l===2047)return a.push(0);l<127?a.push(l):(l>2047&&(l=2047),a.push(192|l>>6),a.push(128|l&63))}else{if(l===255)return a.push(0);l>127&&(l=127),a.push(l)}}function f(a,l){if(s.vt300Mouse){a&=3,l.x-=32,l.y-=32;var c="\x1B[24";if(a===0)c+="1";else if(a===1)c+="3";else if(a===2)c+="5";else{if(a===3)return;c+="0"}c+="~["+l.x+","+l.y+"]\r",s.send(c);return}if(s.decLocator){a&=3,l.x-=32,l.y-=32,a===0?a=2:a===1?a=4:a===2?a=6:a===3&&(a=3),s.send("\x1B["+a+";"+(a===3?4:0)+";"+l.y+";"+l.x+";"+(l.page||0)+"&w");return}if(s.urxvtMouse){l.x-=32,l.y-=32,l.x++,l.y++,s.send("\x1B["+a+";"+l.x+";"+l.y+"M");return}if(s.sgrMouse){l.x-=32,l.y-=32,s.send("\x1B[<"+((a&3)===3?a&-4:a)+";"+l.x+";"+l.y+((a&3)===3?"m":"M"));return}var c=[];o(c,a),o(c,l.x),o(c,l.y),s.send("\x1B[M"+B.fromCharCode.apply(B,c))}function u(a){var l,c,w,g,k;switch(a.type){case"mousedown":l=a.button!=null?+a.button:a.which!=null?a.which-1:null,s.isMSIE&&(l=l===1?0:l===4?1:l);break;case"mouseup":l=3;break;case"DOMMouseScroll":l=a.detail<0?64:65;break;case"mousewheel":l=a.wheelDeltaY>0?64:65;break}return c=a.shiftKey?4:0,w=a.metaKey?8:0,g=a.ctrlKey?16:0,k=c|w|g,s.vt200Mouse?k&=g:s.normalMouse||(k=0),l=32+(k<<2)+l,l}function p(a){var l,c,w,g,k;if(a.pageX!=null){for(l=a.pageX,c=a.pageY,k=s.element;k&&k!==s.document.documentElement;)l-=k.offsetLeft,c-=k.offsetTop,k="offsetParent"in k?k.offsetParent:k.parentNode;return w=s.element.clientWidth,g=s.element.clientHeight,l=Math.round(l/w*s.cols),c=Math.round(c/g*s.rows),l<0&&(l=0),l>s.cols&&(l=s.cols),c<0&&(c=0),c>s.rows&&(c=s.rows),l+=32,c+=32,{x:l,y:c,type:a.type===i?"mousewheel":a.type}}}C(t,"mousedown",function(a){if(s.mouseEvents)return n(a),s.focus(),s.vt200Mouse?(n({__proto__:a,type:"mouseup"}),M(a)):(s.normalMouse&&C(s.document,"mousemove",h),s.x10Mouse||C(s.document,"mouseup",function l(c){return n(c),s.normalMouse&&F(s.document,"mousemove",h),F(s.document,"mouseup",l),M(c)}),M(a))}),C(t,i,function(a){if(s.mouseEvents&&!(s.x10Mouse||s.vt300Mouse||s.decLocator))return n(a),M(a)}),C(t,i,function(a){if(!s.mouseEvents&&!s.applicationKeypad)return a.type==="DOMMouseScroll"?s.scrollDisp(a.detail<0?-5:5):s.scrollDisp(a.wheelDeltaY>0?-5:5),M(a)})},r.prototype.destroy=function(){this.readable=!1,this.writable=!1,this._events={},this.handler=function(){},this.write=function(){},this.element.parentNode&&this.element.parentNode.removeChild(this.element)},r.prototype.refresh=function(t,s){var e,i,n,h,o,f,u,p,a,l,c,w,g,k;for(s-t>=this.rows/2&&(k=this.element.parentNode,k&&k.removeChild(this.element)),u=this.cols,i=t,s>=this.lines.length&&(this.log("`end` is too large. Most likely a bad CSR."),s=this.lines.length-1);i<=s;i++){for(g=i+this.ydisp,h=this.lines[g],o="",i===this.y&&this.cursorState&&(this.ydisp===this.ybase||this.selectMode)&&!this.cursorHidden?e=this.x:e=-1,a=this.defAttr,n=0;n<u;n++){switch(p=h[n][0],f=h[n][1],n===e&&(p=-1),p!==a&&(a!==this.defAttr&&(o+="</span>"),p!==this.defAttr&&(p===-1?o+='<span class="reverse-video terminal-cursor">':(o+='<span style="',l=p&511,c=p>>9&511,w=p>>18,w&1&&(r.brokenBold||(o+="font-weight:bold;"),c<8&&(c+=8)),w&2&&(o+="text-decoration:underline;"),w&4&&(w&2?(o=o.slice(0,-1),o+=" blink;"):o+="text-decoration:blink;"),w&8&&(l=p>>9&511,c=p&511,w&1&&c<8&&(c+=8)),w&16&&(o+="visibility:hidden;"),l!==256&&(o+="background-color:"+this.colors[l]+";"),c!==257&&(o+="color:"+this.colors[c]+";"),o+='">'))),f){case"&":o+="&amp;";break;case"<":o+="&lt;";break;case">":o+="&gt;";break;default:f<=" "?o+="&nbsp;":(R(f)&&n++,o+=f);break}a=p}a!==this.defAttr&&(o+="</span>"),this.children[i].innerHTML=o}k&&k.appendChild(this.element)},r.prototype._cursorBlink=function(){r.focus===this&&(this.cursorState^=1,this.refresh(this.y,this.y))},r.prototype.showCursor=function(){this.cursorState||(this.cursorState=1,this.refresh(this.y,this.y))},r.prototype.startBlink=function(){if(this.cursorBlink){var t=this;this._blinker=function(){t._cursorBlink()},this._blink=N(this._blinker,500)}},r.prototype.refreshBlink=function(){this.cursorBlink&&(clearInterval(this._blink),this._blink=N(this._blinker,500))},r.prototype.scroll=function(){var t;++this.ybase===this.scrollback&&(this.ybase=this.ybase/2|0,this.lines=this.lines.slice(-(this.ybase+this.rows)+1)),this.ydisp=this.ybase,t=this.ybase+this.rows-1,t-=this.rows-1-this.scrollBottom,t===this.lines.length?this.lines.push(this.blankLine()):this.lines.splice(t,0,this.blankLine()),this.scrollTop!==0&&(this.ybase!==0&&(this.ybase--,this.ydisp=this.ybase),this.lines.splice(this.ybase+this.scrollTop,1)),this.updateRange(this.scrollTop),this.updateRange(this.scrollBottom)},r.prototype.scrollDisp=function(t){this.ydisp+=t,this.ydisp>this.ybase?this.ydisp=this.ybase:this.ydisp<0&&(this.ydisp=0),this.refresh(0,this.rows-1)},r.prototype.write=function(t){var s=t.length,e=0,i,n,h;for(this.refreshStart=this.y,this.refreshEnd=this.y,this.ybase!==this.ydisp&&(this.ydisp=this.ybase,this.maxRange());e<s;e++)switch(h=t[e],this.state){case x:switch(h){case"\x07":this.bell();break;case`
`:case"\v":case"\f":this.convertEol&&(this.x=0),this.y++,this.y>this.scrollBottom&&(this.y--,this.scroll());break;case"\r":this.x=0;break;case"\b":this.x>0&&this.x--;break;case"	":this.x=this.nextStop();break;case"":this.setgLevel(1);break;case"":this.setgLevel(0);break;case"\x1B":this.state=_;break;default:if(h>=" "&&(this.charset&&this.charset[h]&&(h=this.charset[h]),this.x>=this.cols&&(this.x=0,this.y++,this.y>this.scrollBottom&&(this.y--,this.scroll())),this.lines[this.y+this.ybase][this.x]=[this.curAttr,h],this.x++,this.updateRange(this.y),R(h))){if(i=this.y+this.ybase,this.cols<2||this.x>=this.cols){this.lines[i][this.x-1]=[this.curAttr," "];break}this.lines[i][this.x]=[this.curAttr," "],this.x++}break}break;case _:switch(h){case"[":this.params=[],this.currentParam=0,this.state=S;break;case"]":this.params=[],this.currentParam=0,this.state=P;break;case"P":this.params=[],this.currentParam=0,this.state=q;break;case"_":this.state=L;break;case"^":this.state=L;break;case"c":this.reset();break;case"E":this.x=0;case"D":this.index();break;case"M":this.reverseIndex();break;case"%":this.setgLevel(0),this.setgCharset(0,r.charsets.US),this.state=x,e++;break;case"(":case")":case"*":case"+":case"-":case".":switch(h){case"(":this.gcharset=0;break;case")":this.gcharset=1;break;case"*":this.gcharset=2;break;case"+":this.gcharset=3;break;case"-":this.gcharset=1;break;case".":this.gcharset=2;break}this.state=D;break;case"/":this.gcharset=3,this.state=D,e--;break;case"N":break;case"O":break;case"n":this.setgLevel(2);break;case"o":this.setgLevel(3);break;case"|":this.setgLevel(3);break;case"}":this.setgLevel(2);break;case"~":this.setgLevel(1);break;case"7":this.saveCursor(),this.state=x;break;case"8":this.restoreCursor(),this.state=x;break;case"#":this.state=x,e++;break;case"H":this.tabSet();break;case"=":this.log("Serial port requested application keypad."),this.applicationKeypad=!0,this.state=x;break;case">":this.log("Switching back to normal keypad."),this.applicationKeypad=!1,this.state=x;break;default:this.state=x,this.error("Unknown ESC control: %s.",h);break}break;case D:switch(h){case"0":n=r.charsets.SCLD;break;case"A":n=r.charsets.UK;break;case"B":n=r.charsets.US;break;case"4":n=r.charsets.Dutch;break;case"C":case"5":n=r.charsets.Finnish;break;case"R":n=r.charsets.French;break;case"Q":n=r.charsets.FrenchCanadian;break;case"K":n=r.charsets.German;break;case"Y":n=r.charsets.Italian;break;case"E":case"6":n=r.charsets.NorwegianDanish;break;case"Z":n=r.charsets.Spanish;break;case"H":case"7":n=r.charsets.Swedish;break;case"=":n=r.charsets.Swiss;break;case"/":n=r.charsets.ISOLatin,e++;break;default:n=r.charsets.US;break}this.setgCharset(this.gcharset,n),this.gcharset=null,this.state=x;break;case P:if(h==="\x1B"||h==="\x07"){switch(h==="\x1B"&&e++,this.params.push(this.currentParam),this.params[0]){case 0:case 1:case 2:this.params[1]&&(this.title=this.params[1],this.handleTitle(this.title));break;case 3:break;case 4:case 5:break;case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:break;case 46:break;case 50:break;case 51:break;case 52:break;case 104:case 105:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:break}this.params=[],this.currentParam=0,this.state=x}else this.params.length?this.currentParam+=h:h>="0"&&h<="9"?this.currentParam=this.currentParam*10+h.charCodeAt(0)-48:h===";"&&(this.params.push(this.currentParam),this.currentParam="");break;case S:if(h==="?"||h===">"||h==="!"){this.prefix=h;break}if(h>="0"&&h<="9"){this.currentParam=this.currentParam*10+h.charCodeAt(0)-48;break}if(h==="$"||h==='"'||h===" "||h==="'"){this.postfix=h;break}if(this.params.push(this.currentParam),this.currentParam=0,h===";")break;switch(this.state=x,h){case"A":this.cursorUp(this.params);break;case"B":this.cursorDown(this.params);break;case"C":this.cursorForward(this.params);break;case"D":this.cursorBackward(this.params);break;case"H":this.cursorPos(this.params);break;case"J":this.eraseInDisplay(this.params);break;case"K":this.eraseInLine(this.params);break;case"m":this.prefix||this.charAttributes(this.params);break;case"n":this.prefix||this.deviceStatus(this.params);break;case"@":this.insertChars(this.params);break;case"E":this.cursorNextLine(this.params);break;case"F":this.cursorPrecedingLine(this.params);break;case"G":this.cursorCharAbsolute(this.params);break;case"L":this.insertLines(this.params);break;case"M":this.deleteLines(this.params);break;case"P":this.deleteChars(this.params);break;case"X":this.eraseChars(this.params);break;case"`":this.charPosAbsolute(this.params);break;case"a":this.HPositionRelative(this.params);break;case"c":this.sendDeviceAttributes(this.params);break;case"d":this.linePosAbsolute(this.params);break;case"e":this.VPositionRelative(this.params);break;case"f":this.HVPosition(this.params);break;case"h":this.setMode(this.params);break;case"l":this.resetMode(this.params);break;case"r":this.setScrollRegion(this.params);break;case"s":this.saveCursor(this.params);break;case"u":this.restoreCursor(this.params);break;case"I":this.cursorForwardTab(this.params);break;case"S":this.scrollUp(this.params);break;case"T":this.params.length<2&&!this.prefix&&this.scrollDown(this.params);break;case"Z":this.cursorBackwardTab(this.params);break;case"b":this.repeatPrecedingCharacter(this.params);break;case"g":this.tabClear(this.params);break;case"p":switch(this.prefix){case"!":this.softReset(this.params);break}break;default:this.error("Unknown CSI code: %s.",h);break}this.prefix="",this.postfix="";break;case q:if(h==="\x1B"||h==="\x07"){switch(h==="\x1B"&&e++,this.prefix){case"":break;case"$q":var o=this.currentParam,f=!1;switch(o){case'"q':o='0"q';break;case'"p':o='61"p';break;case"r":o=""+(this.scrollTop+1)+";"+(this.scrollBottom+1)+"r";break;case"m":o="0m";break;default:this.error("Unknown DCS Pt: %s.",o),o="";break}this.send("\x1BP"+ +f+"$r"+o+"\x1B\\");break;case"+p":break;case"+q":var o=this.currentParam,f=!1;this.send("\x1BP"+ +f+"+r"+o+"\x1B\\");break;default:this.error("Unknown DCS prefix: %s.",this.prefix);break}this.currentParam=0,this.prefix="",this.state=x}else this.currentParam?this.currentParam+=h:!this.prefix&&h!=="$"&&h!=="+"?this.currentParam=h:this.prefix.length===2?this.currentParam=h:this.prefix+=h;break;case L:(h==="\x1B"||h==="\x07")&&(h==="\x1B"&&e++,this.state=x);break}this.updateRange(this.y),this.refresh(this.refreshStart,this.refreshEnd)},r.prototype.writeln=function(t){this.write(t+`\r
`)},r.prototype.keyDown=function(t){var s=this,e;switch(t.keyCode){case 8:if(t.shiftKey){e="\b";break}e="\x7F";break;case 9:if(t.shiftKey){e="\x1B[Z";break}e="	";break;case 13:e="\r";break;case 27:e="\x1B";break;case 37:if(this.applicationCursor){e="\x1BOD";break}e="\x1B[D";break;case 39:if(this.applicationCursor){e="\x1BOC";break}e="\x1B[C";break;case 38:if(this.applicationCursor){e="\x1BOA";break}if(t.ctrlKey)return this.scrollDisp(-1),M(t);e="\x1B[A";break;case 40:if(this.applicationCursor){e="\x1BOB";break}if(t.ctrlKey)return this.scrollDisp(1),M(t);e="\x1B[B";break;case 46:e="\x1B[3~";break;case 45:e="\x1B[2~";break;case 36:if(this.applicationKeypad){e="\x1BOH";break}e="\x1BOH";break;case 35:if(this.applicationKeypad){e="\x1BOF";break}e="\x1BOF";break;case 33:if(t.shiftKey)return this.scrollDisp(-(this.rows-1)),M(t);e="\x1B[5~";break;case 34:if(t.shiftKey)return this.scrollDisp(this.rows-1),M(t);e="\x1B[6~";break;case 112:e="\x1BOP";break;case 113:e="\x1BOQ";break;case 114:e="\x1BOR";break;case 115:e="\x1BOS";break;case 116:e="\x1B[15~";break;case 117:e="\x1B[17~";break;case 118:e="\x1B[18~";break;case 119:e="\x1B[19~";break;case 120:e="\x1B[20~";break;case 121:e="\x1B[21~";break;case 122:e="\x1B[23~";break;case 123:e="\x1B[24~";break;default:if(t.ctrlKey)if(t.keyCode>=65&&t.keyCode<=90){if(this.screenKeys&&!this.prefixMode&&!this.selectMode&&t.keyCode===65)return this.enterPrefix(),M(t);if(this.prefixMode&&t.keyCode===86){this.leavePrefix();return}if((this.prefixMode||this.selectMode)&&t.keyCode===67){this.visualMode&&A(function(){s.leaveVisual()},1);return}e=B.fromCharCode(t.keyCode-64)}else t.keyCode===32?e=B.fromCharCode(0):t.keyCode>=51&&t.keyCode<=55?e=B.fromCharCode(t.keyCode-51+27):t.keyCode===56?e=B.fromCharCode(127):t.keyCode===219?e=B.fromCharCode(27):t.keyCode===221&&(e=B.fromCharCode(29));else(!this.isMac&&t.altKey||this.isMac&&t.metaKey)&&(t.keyCode>=65&&t.keyCode<=90?e="\x1B"+B.fromCharCode(t.keyCode+32):t.keyCode===192?e="\x1B`":t.keyCode>=48&&t.keyCode<=57&&(e="\x1B"+(t.keyCode-48)));break}return e?this.prefixMode?(this.leavePrefix(),M(t)):this.selectMode?(this.keySelect(t,e),M(t)):(this.emit("keydown",t),this.emit("key",e,t),this.showCursor(),this.handler(e),M(t)):!0},r.prototype.setgLevel=function(t){this.glevel=t,this.charset=this.charsets[t]},r.prototype.setgCharset=function(t,s){this.charsets[t]=s,this.glevel===t&&(this.charset=s)},r.prototype.keyPress=function(t){var s;if(M(t),t.charCode)s=t.charCode;else if(t.which==null)s=t.keyCode;else if(t.which!==0&&t.charCode!==0)s=t.which;else return!1;return!s||t.ctrlKey||t.altKey||t.metaKey?!1:(s=B.fromCharCode(s),this.prefixMode?(this.leavePrefix(),this.keyPrefix(t,s),!1):this.selectMode?(this.keySelect(t,s),!1):(this.emit("keypress",s,t),this.emit("key",s,t),this.showCursor(),this.handler(s),!1))},r.prototype.send=function(t){var s=this;this.queue||A(function(){s.handler(s.queue),s.queue=""},1),this.queue+=t},r.prototype.bell=function(){if(this.emit("bell"),!!this.visualBell){var t=this;this.element.style.borderColor="white",A(function(){t.element.style.borderColor=""},10),this.popOnBell&&this.focus()}},r.prototype.log=function(){if(this.debug&&!(!this.context.console||!this.context.console.log)){var t=Array.prototype.slice.call(arguments);this.context.console.log.apply(this.context.console,t)}},r.prototype.error=function(){if(this.debug&&!(!this.context.console||!this.context.console.error)){var t=Array.prototype.slice.call(arguments);this.context.console.error.apply(this.context.console,t)}},r.prototype.resize=function(t,s){var e,i,n,h,o;if(t<1&&(t=1),s<1&&(s=1),h=this.cols,h<t)for(o=[this.defAttr," "],n=this.lines.length;n--;)for(;this.lines[n].length<t;)this.lines[n].push(o);else if(h>t)for(n=this.lines.length;n--;)for(;this.lines[n].length>t;)this.lines[n].pop();if(this.setupStops(h),this.cols=t,h=this.rows,h<s)for(i=this.element;h++<s;)this.lines.length<s+this.ybase&&this.lines.push(this.blankLine()),this.children.length<s&&(e=this.document.createElement("div"),i.appendChild(e),this.children.push(e));else if(h>s){for(;h-- >s;)if(this.lines.length>s+this.ybase&&this.lines.pop(),this.children.length>s){if(i=this.children.pop(),!i)continue;i.parentNode.removeChild(i)}}this.rows=s,this.y>=s&&(this.y=s-1),this.x>=t&&(this.x=t-1),this.scrollTop=0,this.scrollBottom=s-1,this.refresh(0,this.rows-1),this.normal=null},r.prototype.updateRange=function(t){t<this.refreshStart&&(this.refreshStart=t),t>this.refreshEnd&&(this.refreshEnd=t)},r.prototype.maxRange=function(){this.refreshStart=0,this.refreshEnd=this.rows-1},r.prototype.setupStops=function(t){for(t!=null?this.tabs[t]||(t=this.prevStop(t)):(this.tabs={},t=0);t<this.cols;t+=8)this.tabs[t]=!0},r.prototype.prevStop=function(t){for(t==null&&(t=this.x);!this.tabs[--t]&&t>0;);return t>=this.cols?this.cols-1:t<0?0:t},r.prototype.nextStop=function(t){for(t==null&&(t=this.x);!this.tabs[++t]&&t<this.cols;);return t>=this.cols?this.cols-1:t<0?0:t},r.prototype.eraseRight=function(t,s){for(var e=this.lines[this.ybase+s],i=[this.eraseAttr()," "];t<this.cols;t++)e[t]=i;this.updateRange(s)},r.prototype.eraseLeft=function(t,s){var e=this.lines[this.ybase+s],i=[this.eraseAttr()," "];for(t++;t--;)e[t]=i;this.updateRange(s)},r.prototype.eraseLine=function(t){this.eraseRight(0,t)},r.prototype.blankLine=function(t){for(var s=t?this.eraseAttr():this.defAttr,e=[s," "],i=[],n=0;n<this.cols;n++)i[n]=e;return i},r.prototype.ch=function(t){return t?[this.eraseAttr()," "]:[this.defAttr," "]},r.prototype.is=function(t){var s=this.termName;return(s+"").indexOf(t)===0},r.prototype.handler=function(t){this.emit("data",t)},r.prototype.handleTitle=function(t){this.emit("title",t)},r.prototype.index=function(){this.y++,this.y>this.scrollBottom&&(this.y--,this.scroll()),this.state=x},r.prototype.reverseIndex=function(){var t;this.y--,this.y<this.scrollTop&&(this.y++,this.lines.splice(this.y+this.ybase,0,this.blankLine(!0)),t=this.rows-1-this.scrollBottom,this.lines.splice(this.rows-1+this.ybase-t+1,1),this.updateRange(this.scrollTop),this.updateRange(this.scrollBottom)),this.state=x},r.prototype.reset=function(){this.options.rows=this.rows,this.options.cols=this.cols,r.call(this,this.options),this.refresh(0,this.rows-1)},r.prototype.tabSet=function(){this.tabs[this.x]=!0,this.state=x},r.prototype.cursorUp=function(t){var s=t[0];s<1&&(s=1),this.y-=s,this.y<0&&(this.y=0)},r.prototype.cursorDown=function(t){var s=t[0];s<1&&(s=1),this.y+=s,this.y>=this.rows&&(this.y=this.rows-1)},r.prototype.cursorForward=function(t){var s=t[0];s<1&&(s=1),this.x+=s,this.x>=this.cols&&(this.x=this.cols-1)},r.prototype.cursorBackward=function(t){var s=t[0];s<1&&(s=1),this.x-=s,this.x<0&&(this.x=0)},r.prototype.cursorPos=function(t){var s,e;s=t[0]-1,t.length>=2?e=t[1]-1:e=0,s<0?s=0:s>=this.rows&&(s=this.rows-1),e<0?e=0:e>=this.cols&&(e=this.cols-1),this.x=e,this.y=s},r.prototype.eraseInDisplay=function(t){var s;switch(t[0]){case 0:for(this.eraseRight(this.x,this.y),s=this.y+1;s<this.rows;s++)this.eraseLine(s);break;case 1:for(this.eraseLeft(this.x,this.y),s=this.y;s--;)this.eraseLine(s);break;case 2:for(s=this.rows;s--;)this.eraseLine(s);break;case 3:break}},r.prototype.eraseInLine=function(t){switch(t[0]){case 0:this.eraseRight(this.x,this.y);break;case 1:this.eraseLeft(this.x,this.y);break;case 2:this.eraseLine(this.y);break}},r.prototype.charAttributes=function(t){if(t.length===1&&t[0]===0){this.curAttr=this.defAttr;return}for(var s=t.length,e=0,i=this.curAttr>>18,n=this.curAttr>>9&511,h=this.curAttr&511,o;e<s;e++)o=t[e],o>=30&&o<=37?n=o-30:o>=40&&o<=47?h=o-40:o>=90&&o<=97?(o+=8,n=o-90):o>=100&&o<=107?(o+=8,h=o-100):o===0?(i=this.defAttr>>18,n=this.defAttr>>9&511,h=this.defAttr&511):o===1?i|=1:o===4?i|=2:o===5?i|=4:o===7?i|=8:o===8?i|=16:o===22?i&=-2:o===24?i&=-3:o===25?i&=-5:o===27?i&=-9:o===28?i&=-17:o===39?n=this.defAttr>>9&511:o===49?h=this.defAttr&511:o===38?t[e+1]===2?(e+=2,n=E(t[e]&255,t[e+1]&255,t[e+2]&255),n===-1&&(n=511),e+=2):t[e+1]===5&&(e+=2,o=t[e]&255,n=o):o===48?t[e+1]===2?(e+=2,h=E(t[e]&255,t[e+1]&255,t[e+2]&255),h===-1&&(h=511),e+=2):t[e+1]===5&&(e+=2,o=t[e]&255,h=o):o===100?(n=this.defAttr>>9&511,h=this.defAttr&511):this.error("Unknown SGR attribute: %d.",o);this.curAttr=i<<18|n<<9|h},r.prototype.deviceStatus=function(t){if(this.prefix){if(this.prefix==="?")switch(t[0]){case 6:this.send("\x1B[?"+(this.y+1)+";"+(this.x+1)+"R");break;case 15:break;case 25:break;case 26:break;case 53:break}}else switch(t[0]){case 5:this.send("\x1B[0n");break;case 6:this.send("\x1B["+(this.y+1)+";"+(this.x+1)+"R");break}},r.prototype.insertChars=function(t){var s,e,i,n;for(s=t[0],s<1&&(s=1),e=this.y+this.ybase,i=this.x,n=[this.eraseAttr()," "];s--&&i<this.cols;)this.lines[e].splice(i++,0,n),this.lines[e].pop()},r.prototype.cursorNextLine=function(t){var s=t[0];s<1&&(s=1),this.y+=s,this.y>=this.rows&&(this.y=this.rows-1),this.x=0},r.prototype.cursorPrecedingLine=function(t){var s=t[0];s<1&&(s=1),this.y-=s,this.y<0&&(this.y=0),this.x=0},r.prototype.cursorCharAbsolute=function(t){var s=t[0];s<1&&(s=1),this.x=s-1},r.prototype.insertLines=function(t){var s,e,i;for(s=t[0],s<1&&(s=1),e=this.y+this.ybase,i=this.rows-1-this.scrollBottom,i=this.rows-1+this.ybase-i+1;s--;)this.lines.splice(e,0,this.blankLine(!0)),this.lines.splice(i,1);this.updateRange(this.y),this.updateRange(this.scrollBottom)},r.prototype.deleteLines=function(t){var s,e,i;for(s=t[0],s<1&&(s=1),e=this.y+this.ybase,i=this.rows-1-this.scrollBottom,i=this.rows-1+this.ybase-i;s--;)this.lines.splice(i+1,0,this.blankLine(!0)),this.lines.splice(e,1);this.updateRange(this.y),this.updateRange(this.scrollBottom)},r.prototype.deleteChars=function(t){var s,e,i;for(s=t[0],s<1&&(s=1),e=this.y+this.ybase,i=[this.eraseAttr()," "];s--;)this.lines[e].splice(this.x,1),this.lines[e].push(i)},r.prototype.eraseChars=function(t){var s,e,i,n;for(s=t[0],s<1&&(s=1),e=this.y+this.ybase,i=this.x,n=[this.eraseAttr()," "];s--&&i<this.cols;)this.lines[e][i++]=n},r.prototype.charPosAbsolute=function(t){var s=t[0];s<1&&(s=1),this.x=s-1,this.x>=this.cols&&(this.x=this.cols-1)},r.prototype.HPositionRelative=function(t){var s=t[0];s<1&&(s=1),this.x+=s,this.x>=this.cols&&(this.x=this.cols-1)},r.prototype.sendDeviceAttributes=function(t){t[0]>0||(this.prefix?this.prefix===">"&&(this.is("xterm")?this.send("\x1B[>0;276;0c"):this.is("rxvt-unicode")?this.send("\x1B[>85;95;0c"):this.is("linux")?this.send(t[0]+"c"):this.is("screen")&&this.send("\x1B[>83;40003;0c")):this.is("xterm")||this.is("rxvt-unicode")||this.is("screen")?this.send("\x1B[?1;2c"):this.is("linux")&&this.send("\x1B[?6c"))},r.prototype.linePosAbsolute=function(t){var s=t[0];s<1&&(s=1),this.y=s-1,this.y>=this.rows&&(this.y=this.rows-1)},r.prototype.VPositionRelative=function(t){var s=t[0];s<1&&(s=1),this.y+=s,this.y>=this.rows&&(this.y=this.rows-1)},r.prototype.HVPosition=function(t){t[0]<1&&(t[0]=1),t[1]<1&&(t[1]=1),this.y=t[0]-1,this.y>=this.rows&&(this.y=this.rows-1),this.x=t[1]-1,this.x>=this.cols&&(this.x=this.cols-1)},r.prototype.setMode=function(t){if(typeof t=="object"){for(var s=t.length,e=0;e<s;e++)this.setMode(t[e]);return}if(this.prefix){if(this.prefix==="?")switch(t){case 1:this.applicationCursor=!0;break;case 2:this.setgCharset(0,r.charsets.US),this.setgCharset(1,r.charsets.US),this.setgCharset(2,r.charsets.US),this.setgCharset(3,r.charsets.US);break;case 3:this.savedCols=this.cols,this.resize(132,this.rows);break;case 6:this.originMode=!0;break;case 7:this.wraparoundMode=!0;break;case 12:break;case 66:this.log("Serial port requested application keypad."),this.applicationKeypad=!0;break;case 9:case 1e3:case 1002:case 1003:this.x10Mouse=t===9,this.vt200Mouse=t===1e3,this.normalMouse=t>1e3,this.mouseEvents=!0,this.element.style.cursor="default",this.log("Binding to mouse events.");break;case 1004:this.sendFocus=!0;break;case 1005:this.utfMouse=!0;break;case 1006:this.sgrMouse=!0;break;case 1015:this.urxvtMouse=!0;break;case 25:this.cursorHidden=!1;break;case 1049:case 47:case 1047:if(!this.normal){var i={lines:this.lines,ybase:this.ybase,ydisp:this.ydisp,x:this.x,y:this.y,scrollTop:this.scrollTop,scrollBottom:this.scrollBottom,tabs:this.tabs};this.reset(),this.normal=i,this.showCursor()}break}}else switch(t){case 4:this.insertMode=!0;break;case 20:break}},r.prototype.resetMode=function(t){if(typeof t=="object"){for(var s=t.length,e=0;e<s;e++)this.resetMode(t[e]);return}if(this.prefix){if(this.prefix==="?")switch(t){case 1:this.applicationCursor=!1;break;case 3:this.cols===132&&this.savedCols&&this.resize(this.savedCols,this.rows),delete this.savedCols;break;case 6:this.originMode=!1;break;case 7:this.wraparoundMode=!1;break;case 12:break;case 66:this.log("Switching back to normal keypad."),this.applicationKeypad=!1;break;case 9:case 1e3:case 1002:case 1003:this.x10Mouse=!1,this.vt200Mouse=!1,this.normalMouse=!1,this.mouseEvents=!1,this.element.style.cursor="";break;case 1004:this.sendFocus=!1;break;case 1005:this.utfMouse=!1;break;case 1006:this.sgrMouse=!1;break;case 1015:this.urxvtMouse=!1;break;case 25:this.cursorHidden=!0;break;case 1049:case 47:case 1047:this.normal&&(this.lines=this.normal.lines,this.ybase=this.normal.ybase,this.ydisp=this.normal.ydisp,this.x=this.normal.x,this.y=this.normal.y,this.scrollTop=this.normal.scrollTop,this.scrollBottom=this.normal.scrollBottom,this.tabs=this.normal.tabs,this.normal=null,this.refresh(0,this.rows-1),this.showCursor());break}}else switch(t){case 4:this.insertMode=!1;break;case 20:break}},r.prototype.setScrollRegion=function(t){this.prefix||(this.scrollTop=(t[0]||1)-1,this.scrollBottom=(t[1]||this.rows)-1,this.x=0,this.y=0)},r.prototype.saveCursor=function(t){this.savedX=this.x,this.savedY=this.y},r.prototype.restoreCursor=function(t){this.x=this.savedX||0,this.y=this.savedY||0},r.prototype.cursorForwardTab=function(t){for(var s=t[0]||1;s--;)this.x=this.nextStop()},r.prototype.scrollUp=function(t){for(var s=t[0]||1;s--;)this.lines.splice(this.ybase+this.scrollTop,1),this.lines.splice(this.ybase+this.scrollBottom,0,this.blankLine());this.updateRange(this.scrollTop),this.updateRange(this.scrollBottom)},r.prototype.scrollDown=function(t){for(var s=t[0]||1;s--;)this.lines.splice(this.ybase+this.scrollBottom,1),this.lines.splice(this.ybase+this.scrollTop,0,this.blankLine());this.updateRange(this.scrollTop),this.updateRange(this.scrollBottom)},r.prototype.initMouseTracking=function(t){},r.prototype.resetTitleModes=function(t){},r.prototype.cursorBackwardTab=function(t){for(var s=t[0]||1;s--;)this.x=this.prevStop()},r.prototype.repeatPrecedingCharacter=function(t){for(var s=t[0]||1,e=this.lines[this.ybase+this.y],i=e[this.x-1]||[this.defAttr," "];s--;)e[this.x++]=i},r.prototype.tabClear=function(t){var s=t[0];s<=0?delete this.tabs[this.x]:s===3&&(this.tabs={})},r.prototype.mediaCopy=function(t){},r.prototype.setResources=function(t){},r.prototype.disableModifiers=function(t){},r.prototype.setPointerMode=function(t){},r.prototype.softReset=function(t){this.cursorHidden=!1,this.insertMode=!1,this.originMode=!1,this.wraparoundMode=!1,this.applicationKeypad=!1,this.applicationCursor=!1,this.scrollTop=0,this.scrollBottom=this.rows-1,this.curAttr=this.defAttr,this.x=this.y=0,this.charset=null,this.glevel=0,this.charsets=[null]},r.prototype.requestAnsiMode=function(t){},r.prototype.requestPrivateMode=function(t){},r.prototype.setConformanceLevel=function(t){},r.prototype.loadLEDs=function(t){},r.prototype.setCursorStyle=function(t){},r.prototype.setCharProtectionAttr=function(t){},r.prototype.restorePrivateValues=function(t){},r.prototype.setAttrInRectangle=function(t){for(var s=t[0],e=t[1],i=t[2],n=t[3],h=t[4],o,f;s<i+1;s++)for(o=this.lines[this.ybase+s],f=e;f<n;f++)o[f]=[h,o[f][1]];this.updateRange(t[0]),this.updateRange(t[2])},r.prototype.savePrivateValues=function(t){},r.prototype.manipulateWindow=function(t){},r.prototype.reverseAttrInRectangle=function(t){},r.prototype.setTitleModeFeature=function(t){},r.prototype.setWarningBellVolume=function(t){},r.prototype.setMarginBellVolume=function(t){},r.prototype.copyRectangle=function(t){},r.prototype.enableFilterRectangle=function(t){},r.prototype.requestParameters=function(t){},r.prototype.selectChangeExtent=function(t){},r.prototype.fillRectangle=function(t){for(var s=t[0],e=t[1],i=t[2],n=t[3],h=t[4],o,f;e<n+1;e++)for(o=this.lines[this.ybase+e],f=i;f<h;f++)o[f]=[o[f][0],B.fromCharCode(s)];this.updateRange(t[1]),this.updateRange(t[3])},r.prototype.enableLocatorReporting=function(t){var s=t[0]>0},r.prototype.eraseRectangle=function(t){var s=t[0],e=t[1],i=t[2],n=t[3],h,o,f;for(f=[this.eraseAttr()," "];s<i+1;s++)for(h=this.lines[this.ybase+s],o=e;o<n;o++)h[o]=f;this.updateRange(t[0]),this.updateRange(t[2])},r.prototype.setLocatorEvents=function(t){},r.prototype.selectiveEraseRectangle=function(t){},r.prototype.requestLocatorPosition=function(t){},r.prototype.insertColumns=function(){for(var t=params[0],s=this.ybase+this.rows,e=[this.eraseAttr()," "],i;t--;)for(i=this.ybase;i<s;i++)this.lines[i].splice(this.x+1,0,e),this.lines[i].pop();this.maxRange()},r.prototype.deleteColumns=function(){for(var t=params[0],s=this.ybase+this.rows,e=[this.eraseAttr()," "],i;t--;)for(i=this.ybase;i<s;i++)this.lines[i].splice(this.x,1),this.lines[i].push(e);this.maxRange()},r.prototype.enterPrefix=function(){this.prefixMode=!0},r.prototype.leavePrefix=function(){this.prefixMode=!1},r.prototype.enterSelect=function(){this._real={x:this.x,y:this.y,ydisp:this.ydisp,ybase:this.ybase,cursorHidden:this.cursorHidden,lines:this.copyBuffer(this.lines),write:this.write},this.write=function(){},this.selectMode=!0,this.visualMode=!1,this.cursorHidden=!1,this.refresh(this.y,this.y)},r.prototype.leaveSelect=function(){this.x=this._real.x,this.y=this._real.y,this.ydisp=this._real.ydisp,this.ybase=this._real.ybase,this.cursorHidden=this._real.cursorHidden,this.lines=this._real.lines,this.write=this._real.write,delete this._real,this.selectMode=!1,this.visualMode=!1,this.refresh(0,this.rows-1)},r.prototype.enterVisual=function(){this._real.preVisual=this.copyBuffer(this.lines),this.selectText(this.x,this.x,this.ydisp+this.y,this.ydisp+this.y),this.visualMode=!0},r.prototype.leaveVisual=function(){this.lines=this._real.preVisual,delete this._real.preVisual,delete this._selected,this.visualMode=!1,this.refresh(0,this.rows-1)},r.prototype.enterSearch=function(t){this.entry="",this.searchMode=!0,this.searchDown=t,this._real.preSearch=this.copyBuffer(this.lines),this._real.preSearchX=this.x,this._real.preSearchY=this.y;for(var s=this.ydisp+this.rows-1,e=0;e<this.entryPrefix.length;e++)this.lines[s][e]=[this.defAttr&-512|4,this.entryPrefix[e]];this.y=this.rows-1,this.x=this.entryPrefix.length,this.refresh(this.rows-1,this.rows-1)},r.prototype.leaveSearch=function(){this.searchMode=!1,this._real.preSearch&&(this.lines=this._real.preSearch,this.x=this._real.preSearchX,this.y=this._real.preSearchY,delete this._real.preSearch,delete this._real.preSearchX,delete this._real.preSearchY),this.refresh(this.rows-1,this.rows-1)},r.prototype.copyBuffer=function(s){for(var s=s||this.lines,e=[],i=0;i<s.length;i++){e[i]=[];for(var n=0;n<s[i].length;n++)e[i][n]=[s[i][n][0],s[i][n][1]]}return e},r.prototype.getCopyTextarea=function(t){var s=this._copyTextarea,e=this.document;return s||(s=e.createElement("textarea"),s.style.position="absolute",s.style.left="-32000px",s.style.top="-32000px",s.style.width="0px",s.style.height="0px",s.style.opacity="0",s.style.backgroundColor="transparent",s.style.borderStyle="none",s.style.outlineStyle="none",e.getElementsByTagName("body")[0].appendChild(s),this._copyTextarea=s),s},r.prototype.copyText=function(t){var s=this,e=this.getCopyTextarea();this.emit("copy",t),e.focus(),e.textContent=t,e.value=t,e.setSelectionRange(0,t.length),A(function(){s.element.focus(),s.focus()},1)},r.prototype.selectText=function(t,s,e,i){var n,h,o,f,u,p,a,l,c;if(this._selected){for(n=this._selected.x1,h=this._selected.x2,o=this._selected.y1,f=this._selected.y2,f<o&&(u=h,h=n,n=u,u=f,f=o,o=u),h<n&&o===f&&(u=h,h=n,n=u),a=o;a<=f;a++)for(p=0,l=this.cols-1,a===o&&(p=n),a===f&&(l=h);p<=l;p++)this.lines[a][p].old!=null&&(c=this.lines[a][p].old,delete this.lines[a][p].old,this.lines[a][p]=[c,this.lines[a][p][1]]);e=this._selected.y1,t=this._selected.x1}for(e=Math.max(e,0),e=Math.min(e,this.ydisp+this.rows-1),i=Math.max(i,0),i=Math.min(i,this.ydisp+this.rows-1),this._selected={x1:t,x2:s,y1:e,y2:i},i<e&&(u=s,s=t,t=u,u=i,i=e,e=u),s<t&&e===i&&(u=s,s=t,t=u),a=e;a<=i;a++)for(p=0,l=this.cols-1,a===e&&(p=t),a===i&&(l=s);p<=l;p++)c=this.lines[a][p][0],this.lines[a][p]=[c&-512|261636,this.lines[a][p][1]],this.lines[a][p].old=c;e=e-this.ydisp,i=i-this.ydisp,e=Math.max(e,0),e=Math.min(e,this.rows-1),i=Math.max(i,0),i=Math.min(i,this.rows-1),this.refresh(0,this.rows-1)},r.prototype.grabText=function(t,s,e,i){var n="",h="",o,f,u,p,a;for(i<e&&(a=s,s=t,t=a,a=i,i=e,e=a),s<t&&e===i&&(a=s,s=t,t=a),u=e;u<=i;u++){for(f=0,p=this.cols-1,u===e&&(f=t),u===i&&(p=s);f<=p;f++){if(o=this.lines[u][f][1],o===" "){h+=o;continue}h&&(n+=h,h=""),n+=o,R(o)&&f++}h="",n+=`
`}for(f=s,u=i;f<this.cols;f++)if(this.lines[u][f][1]!==" "){n=n.slice(0,-1);break}return n},r.prototype.keyPrefix=function(t,s){s==="k"||s==="&"?this.destroy():s==="p"||s==="]"?this.emit("request paste"):s==="c"?this.emit("request create"):s>="0"&&s<="9"?(s=+s-1,~s||(s=9),this.emit("request term",s)):s==="n"?this.emit("request term next"):s==="P"?this.emit("request term previous"):s===":"?this.emit("request command mode"):s==="["&&this.enterSelect()},r.prototype.keySelect=function(t,s){if(this.showCursor(),this.searchMode||s==="n"||s==="N")return this.keySearch(t,s);if(s===""){var e=this.ydisp+this.y;this.ydisp===this.ybase?(this.y=Math.min(this.y+(this.rows-1)/2|0,this.rows-1),this.refresh(0,this.rows-1)):this.scrollDisp((this.rows-1)/2|0),this.visualMode&&this.selectText(this.x,this.x,e,this.ydisp+this.y);return}if(s===""){var e=this.ydisp+this.y;this.ydisp===0?(this.y=Math.max(this.y-(this.rows-1)/2|0,0),this.refresh(0,this.rows-1)):this.scrollDisp(-(this.rows-1)/2|0),this.visualMode&&this.selectText(this.x,this.x,e,this.ydisp+this.y);return}if(s===""){var e=this.ydisp+this.y;this.scrollDisp(this.rows-1),this.visualMode&&this.selectText(this.x,this.x,e,this.ydisp+this.y);return}if(s===""){var e=this.ydisp+this.y;this.scrollDisp(-(this.rows-1)),this.visualMode&&this.selectText(this.x,this.x,e,this.ydisp+this.y);return}if(s==="k"||s==="\x1B[A"){var e=this.ydisp+this.y;this.y--,this.y<0&&(this.y=0,this.scrollDisp(-1)),this.visualMode?this.selectText(this.x,this.x,e,this.ydisp+this.y):this.refresh(this.y,this.y+1);return}if(s==="j"||s==="\x1B[B"){var e=this.ydisp+this.y;this.y++,this.y>=this.rows&&(this.y=this.rows-1,this.scrollDisp(1)),this.visualMode?this.selectText(this.x,this.x,e,this.ydisp+this.y):this.refresh(this.y-1,this.y);return}if(s==="h"||s==="\x1B[D"){var i=this.x;this.x--,this.x<0&&(this.x=0),this.visualMode?this.selectText(i,this.x,this.ydisp+this.y,this.ydisp+this.y):this.refresh(this.y,this.y);return}if(s==="l"||s==="\x1B[C"){var i=this.x;this.x++,this.x>=this.cols&&(this.x=this.cols-1),this.visualMode?this.selectText(i,this.x,this.ydisp+this.y,this.ydisp+this.y):this.refresh(this.y,this.y);return}if(s==="v"||s===" "){this.visualMode?this.leaveVisual():this.enterVisual();return}if(s==="y"){if(this.visualMode){var n=this.grabText(this._selected.x1,this._selected.x2,this._selected.y1,this._selected.y2);this.copyText(n),this.leaveVisual()}return}if(s==="q"||s==="\x1B"){this.visualMode?this.leaveVisual():this.leaveSelect();return}if(s==="w"||s==="W"){for(var h=this.x,o=this.y,f=this.ydisp,i=this.x,e=this.y,u=this.ydisp,p=!1;;){for(var a=this.lines[u+e];i<this.cols;){if(a[i][1]<=" ")p=!0;else if(p)break;i++}if(i>=this.cols&&(i=this.cols-1),i===this.cols-1&&a[i][1]<=" "){if(i=0,++e>=this.rows&&(e--,++u>this.ybase)){u=this.ybase,i=this.x;break}continue}break}this.x=i,this.y=e,this.scrollDisp(-this.ydisp+u),this.visualMode&&this.selectText(h,this.x,o+f,this.ydisp+this.y);return}if(s==="b"||s==="B"){for(var h=this.x,o=this.y,f=this.ydisp,i=this.x,e=this.y,u=this.ydisp;;){for(var a=this.lines[u+e],p=i>0&&a[i][1]>" "&&a[i-1][1]>" ";i>=0;){if(a[i][1]<=" ")if(p&&i+1<this.cols&&a[i+1][1]>" "){i++;break}else p=!0;i--}if(i<0&&(i=0),i===0&&(a[i][1]<=" "||!p)){if(i=this.cols-1,--e<0&&(e++,--u<0)){u++,i=0;break}continue}break}this.x=i,this.y=e,this.scrollDisp(-this.ydisp+u),this.visualMode&&this.selectText(h,this.x,o+f,this.ydisp+this.y);return}if(s==="e"||s==="E"){var i=this.x+1,e=this.y,u=this.ydisp;for(i>=this.cols&&i--;;){for(var a=this.lines[u+e];i<this.cols&&a[i][1]<=" ";)i++;for(;i<this.cols;){if(a[i][1]<=" "&&i-1>=0&&a[i-1][1]>" "){i--;break}i++}if(i>=this.cols&&(i=this.cols-1),i===this.cols-1&&a[i][1]<=" "){if(i=0,++e>=this.rows&&(e--,++u>this.ybase)){u=this.ybase;break}continue}break}this.x=i,this.y=e,this.scrollDisp(-this.ydisp+u),this.visualMode&&this.selectText(h,this.x,o+f,this.ydisp+this.y);return}if(s==="^"||s==="0"){var h=this.x;if(s==="0")this.x=0;else if(s==="^"){for(var a=this.lines[this.ydisp+this.y],i=0;i<this.cols&&!(a[i][1]>" ");)i++;i>=this.cols&&(i=this.cols-1),this.x=i}this.visualMode?this.selectText(h,this.x,this.ydisp+this.y,this.ydisp+this.y):this.refresh(this.y,this.y);return}if(s==="$"){for(var h=this.x,a=this.lines[this.ydisp+this.y],i=this.cols-1;i>=0;){if(a[i][1]>" "){this.visualMode&&i<this.cols-1&&i++;break}i--}i<0&&(i=0),this.x=i,this.visualMode?this.selectText(h,this.x,this.ydisp+this.y,this.ydisp+this.y):this.refresh(this.y,this.y);return}if(s==="g"||s==="G"){var h=this.x,o=this.y,f=this.ydisp;s==="g"?(this.x=0,this.y=0,this.scrollDisp(-this.ydisp)):s==="G"&&(this.x=0,this.y=this.rows-1,this.scrollDisp(this.ybase)),this.visualMode&&this.selectText(h,this.x,o+f,this.ydisp+this.y);return}if(s==="H"||s==="M"||s==="L"){var h=this.x,o=this.y;s==="H"?(this.x=0,this.y=0):s==="M"?(this.x=0,this.y=this.rows/2|0):s==="L"&&(this.x=0,this.y=this.rows-1),this.visualMode?this.selectText(h,this.x,this.ydisp+o,this.ydisp+this.y):(this.refresh(o,o),this.refresh(this.y,this.y));return}if(s==="{"||s==="}"){var h=this.x,o=this.y,f=this.ydisp,a,l=!1,c=!1,w=-1,e=this.y+(s==="{"?-1:1),u=this.ydisp,g;for(s==="{"?e<0&&(e++,u>0&&u--):s==="}"&&e>=this.rows&&(e--,u<this.ybase&&u++);;){for(a=this.lines[u+e],g=0;g<this.cols;g++)if(a[g][1]>" "){w===-1&&(w=0),l=!0;break}else if(g===this.cols-1){w===-1?w=1:(w===0||w===1&&l)&&(c=!0);break}if(c)break;if(s==="{"){if(e--,e<0)if(e++,u>0)u--;else break}else if(s==="}"&&(e++,e>=this.rows))if(e--,u<this.ybase)u++;else break}c||(s==="{"?(e=0,u=0):s==="}"&&(e=this.rows-1,u=this.ybase)),this.x=0,this.y=e,this.scrollDisp(-this.ydisp+u),this.visualMode&&this.selectText(h,this.x,o+f,this.ydisp+this.y);return}if(s==="/"||s==="?"){this.visualMode||this.enterSearch(s==="/");return}return!1},r.prototype.keySearch=function(t,s){if(s==="\x1B"){this.leaveSearch();return}if(s==="\r"||!this.searchMode&&(s==="n"||s==="N")){this.leaveSearch();var e=this.entry;if(!e){this.refresh(0,this.rows-1);return}for(var i=this.x,n=this.y,h=this.ydisp,o,f=!1,u=!1,p=this.x+1,a=this.ydisp+this.y,l,c,w=s==="N"?this.searchDown:!this.searchDown;;){for(o=this.lines[a];p<this.cols;){for(c=0;c<e.length&&!(p+c>=this.cols||o[p+c][1]!==e[c]);c++)if(o[p+c][1]===e[c]&&c===e.length-1){f=!0;break}if(f)break;p+=c+1}if(f)break;if(p=0,w){if(a--,a<0){if(u)break;u=!0,a=this.ybase+this.rows-1}}else if(a++,a>this.ybase+this.rows-1){if(u)break;u=!0,a=0}}if(f){a-this.ybase<0?(l=a,a=0,l>this.ybase&&(a=l-this.ybase,l=this.ybase)):(l=this.ybase,a-=this.ybase),this.x=p,this.y=a,this.scrollDisp(-this.ydisp+l),this.visualMode&&this.selectText(i,this.x,n+h,this.ydisp+this.y);return}this.refresh(0,this.rows-1);return}if(s==="\b"||s==="\x7F"){if(this.entry.length===0)return;var g=this.ydisp+this.rows-1;this.entry=this.entry.slice(0,-1);var c=this.entryPrefix.length+this.entry.length;this.lines[g][c]=[this.lines[g][c][0]," "],this.x--,this.refresh(this.rows-1,this.rows-1),this.refresh(this.y,this.y);return}if(s.length===1&&s>=" "&&s<="~"){var g=this.ydisp+this.rows-1;this.entry+=s;var c=this.entryPrefix.length+this.entry.length-1;this.lines[g][c]=[this.defAttr&-512|4,s],this.x++,this.refresh(this.rows-1,this.rows-1),this.refresh(this.y,this.y);return}return!1},r.prototype.exportState=function(){return JSON.stringify({rows:this.rows,cols:this.cols,ybase:this.ybase,ydisp:this.ydisp,x:this.x,y:this.y,cursorState:this.cursorState,cursorHidden:this.cursorHidden,convertEol:this.convertEol,state:this.state,queue:this.queue,scrollTop:this.scrollTop,scrollBottom:this.scrollBottom,applicationKeypad:this.applicationKeypad,applicationCursor:this.applicationCursor,originMode:this.originMode,insertMode:this.insertMode,wraparoundMode:this.wraparoundMode,normal:this.normal,prefixMode:this.prefixMode,selectMode:this.selectMode,visualMode:this.visualMode,searchMode:this.searchMode,searchDown:this.searchDown,entry:this.entry,_real:this._real,_selected:this._selected,charset:this.charset,gcharset:this.gcharset,glevel:this.glevel,charsets:this.charsets,decLocator:this.decLocator,x10Mouse:this.x10Mouse,vt200Mouse:this.vt200Mouse,vt300Mouse:this.vt300Mouse,normalMouse:this.normalMouse,mouseEvents:this.mouseEvents,sendFocus:this.sendFocus,utfMouse:this.utfMouse,sgrMouse:this.sgrMouse,urxvtMouse:this.urxvtMouse,refreshStart:this.refreshStart,refreshEnd:this.refreshEnd,savedX:this.savedX,savedY:this.savedY,savedCols:this.savedCols,curAttr:this.curAttr,params:this.params,currentParam:this.currentParam,prefix:this.prefix,postfix:this.postfix,lines:this.lines,tabs:this.tabs})},r.prototype.importState=function(t){var s=JSON.parse(t);this.reset(),this.rows=s.rows,this.cols=s.cols,this.ybase=s.ybase,this.ydisp=s.ydisp,this.x=s.x,this.y=s.y,this.cursorState=s.cursorState,this.cursorHidden=s.cursorHidden,this.convertEol=s.convertEol,this.state=s.state,this.queue=s.queue,this.scrollTop=s.scrollTop,this.scrollBottom=s.scrollBottom,this.applicationKeypad=s.applicationKeypad,this.applicationCursor=s.applicationCursor,this.originMode=s.originMode,this.insertMode=s.insertMode,this.wraparoundMode=s.wraparoundMode,this.normal=s.normal,this.prefixMode=s.prefixMode,this.selectMode=s.selectMode,this.visualMode=s.visualMode,this.searchMode=s.searchMode,this.searchDown=s.searchDown,this.entry=s.entry,this._real=s._real,this._selected=s._selected,this.charset=s.charset,this.gcharset=s.gcharset,this.glevel=s.glevel,this.charsets=s.charsets,this.decLocator=s.decLocator,this.x10Mouse=s.x10Mouse,this.vt200Mouse=s.vt200Mouse,this.vt300Mouse=s.vt300Mouse,this.normalMouse=s.normalMouse,this.mouseEvents=s.mouseEvents,this.sendFocus=s.sendFocus,this.utfMouse=s.utfMouse,this.sgrMouse=s.sgrMouse,this.urxvtMouse=s.urxvtMouse,this.refreshStart=s.refreshStart,this.refreshEnd=s.refreshEnd,this.savedX=s.savedX,this.savedY=s.savedY,this.savedCols=s.savedCols,this.curAttr=s.curAttr,this.params=s.params,this.currentParam=s.currentParam,this.prefix=s.prefix,this.postfix=s.postfix,this.lines=s.lines,this.tabs=s.tabs,this.refresh(0,this.rows-1)},r.charsets={},r.charsets.SCLD={"`":"\u25C6",a:"\u2592",b:"	",c:"\f",d:"\r",e:`
`,f:"\xB0",g:"\xB1",h:"\u2424",i:"\v",j:"\u2518",k:"\u2510",l:"\u250C",m:"\u2514",n:"\u253C",o:"\u23BA",p:"\u23BB",q:"\u2500",r:"\u23BC",s:"\u23BD",t:"\u251C",u:"\u2524",v:"\u2534",w:"\u252C",x:"\u2502",y:"\u2264",z:"\u2265","{":"\u03C0","|":"\u2260","}":"\xA3","~":"\xB7"},r.charsets.UK=null,r.charsets.US=null,r.charsets.Dutch=null,r.charsets.Finnish=null,r.charsets.French=null,r.charsets.FrenchCanadian=null,r.charsets.German=null,r.charsets.Italian=null,r.charsets.NorwegianDanish=null,r.charsets.Spanish=null,r.charsets.Swedish=null,r.charsets.Swiss=null,r.charsets.ISOLatin=null;function C(t,s,e,i){t.addEventListener(s,e,i||!1)}function F(t,s,e,i){t.removeEventListener(s,e,i||!1)}function M(t){return t.preventDefault&&t.preventDefault(),t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,!1}function I(t,s){function e(){this.constructor=t}e.prototype=s.prototype,t.prototype=new e}function tt(t){var s=t.getElementsByTagName("body")[0],e=t.createElement("span");e.innerHTML="hello world",s.appendChild(e);var i=e.scrollWidth;e.style.fontWeight="bold";var n=e.scrollWidth;return s.removeChild(e),i!==n}var B=this.String,A=this.setTimeout,N=this.setInterval;function st(t,s){for(var e=t.length;e--;)if(t[e]===s)return e;return-1}function R(t){return t<="\uFF00"?!1:t>="\uFF01"&&t<="\uFFBE"||t>="\uFFC2"&&t<="\uFFC7"||t>="\uFFCA"&&t<="\uFFCF"||t>="\uFFD2"&&t<="\uFFD7"||t>="\uFFDA"&&t<="\uFFDC"||t>="\uFFE0"&&t<="\uFFE6"||t>="\uFFE8"&&t<="\uFFEE"}function E(t,s,e){var i=t<<16|s<<8|e;if(E._cache[i]!=null)return E._cache[i];for(var n=1/0,h=-1,o=0,f,u,p,a,l;o<r.vcolors.length;o++){if(f=r.vcolors[o],u=f[0],p=f[1],a=f[2],l=E.distance(t,s,e,u,p,a),l===0){h=o;break}l<n&&(n=l,h=o)}return E._cache[i]=h}E._cache={},E.distance=function(t,s,e,i,n,h){return Math.pow(30*(t-i),2)+Math.pow(59*(s-n),2)+Math.pow(11*(e-h),2)};function U(t,s,e){if(t.forEach)return t.forEach(s,e);for(var i=0;i<t.length;i++)s.call(e,t[i],i,t)}function V(t){if(Object.keys)return Object.keys(t);var s,e=[];for(s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.push(s);return e}r.EventEmitter=b,r.inherits=I,r.on=C,r.off=F,r.cancel=M,typeof y<"u"?y.exports=r:this.Terminal=r}).call(function(){return this||(typeof window<"u"?window:global)}())}});function T(){this._chunks=null,this._frame=0,this._startTime=null,this._tickHandle=null,this.listeners=[]}T.prototype.load=function(d){this._chunks=d,this.rewind()},T.prototype.addListener=function(d){this.listeners.push(d)},T.prototype.removeListener=function(d){this.listeners=this.listeners.filter(function(y){return d!==y})},T.prototype.play=function(){return this._tickHandle||this._frame>=this._chunks.length?!0:(this._emit("play"),this._step(),!1)},T.prototype._emit=function(y,m){this.listeners.forEach(function(v){try{v({type:y,data:m})}catch(b){setTimeout(function(){throw b},0)}}.bind(this))},T.prototype.pause=function(){this._tickHandle&&(this._emit("pause"),clearTimeout(this._tickHandle),this._tickHandle=null,this._startTime=null)},T.prototype.rewind=function(){this.pause(),this._emit("rewind"),this._frame=0},T.prototype._step=function(){var y;this._startTime===null?(this._startTime=new Date().getTime()-this._chunks[this._frame].ms,y=this._startTime):y=new Date().getTime();var m=[],v=this._frame,b;let x;for(x=this._frame;x<this._chunks.length&&this._chunks[x].ms<=y-this._startTime;++x)m.push(this._chunks[x]);if(this._frame=x,m.forEach(function(S){this._emit("data",{data:S.data,frame:v,ms:S.ms})}.bind(this)),this._frame<this._chunks.length){var _=this._chunks[x].ms-y;this._tickHandle=setTimeout(this._step.bind(this),_)}else this._emit("end")};function Z(d){for(var y="",m=0;m<d.length;++m){var v=d[m],b;if(v&128){if(b=0,d[m]&64)if(!(d[m]&32))b=1,v=d[m]&31;else if(!(d[m]&16))b=2,v=d[m]&15;else if(!(d[m]&8))b=3,v=d[m]&7;else throw new Error("Bad UTF-8 Sequence: more than 6 additional chars");else throw new Error("Bad UTF-8 Sequence: mismatch");for(var x=0;x<b;++x){if(m++,m>=d.length)throw new Error("Bad UTF-8 Sequence: need more data");v=v<<6|d[m]&63}if(v>1114111)throw new Error("Bad UTF-8 Sequence: code point too large");if(v>65535){var _=v-65536,S=55296+((_&1047552)>>10),P=56320+(_&1023);y+=String.fromCharCode(S)+String.fromCharCode(P)}else y+=String.fromCharCode(v)}else y+=String.fromCharCode(v)}return y}function H(){}H.prototype.parse=function(d){for(var y=[],m=null,v=0;v<d.byteLength;){var b=new Uint32Array(d.slice(v+0,v+12)),x=b[0],_=b[1],S=b[2],P;m===null?(m=x*1e3+_/1e3,P=0):P=x*1e3+_/1e3-m,v+=12;var D=Z(new Uint8Array(d.slice(v+0,v+S)));v+=S,y.push({ms:P,data:D})}return y};var Q=$(J()),et={Parser:H,Player:T,Terminal:Q.default}})();})();
